(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71903056"],{"13d5":function(t,e,n){"use strict";var a=n("23e7"),r=n("d58f").left,i=n("a640"),s=n("ae40"),u=n("2d00"),c=n("605d"),o=i("reduce"),l=s("reduce",{1:0}),m=!c&&u>79&&u<83;a({target:"Array",proto:!0,forced:!o||!l||m},{reduce:function(t){return r(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"216b":function(t,e,n){},"223c":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"toastification"},[n("div",{staticClass:"d-flex align-items-start"},[n("b-avatar",{staticClass:"mr-75 flex-shrink-0",attrs:{variant:t.variant,size:"1.8rem"}},[n("feather-icon",{attrs:{icon:t.icon,size:"15"}})],1),n("div",{staticClass:"d-flex flex-grow-1"},[n("div",[t.title?n("h5",{staticClass:"mb-0 font-weight-bolder toastification-title",class:"text-"+t.variant,domProps:{textContent:t._s(t.title)}}):t._e(),t.text?n("small",{staticClass:"d-inline-block text-body",domProps:{textContent:t._s(t.text)}}):t._e()]),n("span",{staticClass:"cursor-pointer toastification-close-icon ml-auto ",on:{click:function(e){return t.$emit("close-toast")}}},[t.hideClose?t._e():n("feather-icon",{staticClass:"text-body",attrs:{icon:"XIcon"}})],1)])],1)])},r=[],i=n("e8a3"),s={components:{BAvatar:i["a"]},props:{variant:{type:String,default:"primary"},icon:{type:String,default:null},title:{type:String,default:null},text:{type:String,default:null},hideClose:{type:Boolean,default:!1}}},u=s,c=(n("2edd"),n("2877")),o=Object(c["a"])(u,a,r,!1,null,"55dd3057",null);e["default"]=o.exports},"2edd":function(t,e,n){"use strict";n("216b")},"594e":function(t,e,n){},"627b":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"return-products-container"},[n("div",{staticClass:"page-header"},[n("h2",{staticClass:"mb-0"},[t._v("Return Products")]),n("b-button",{attrs:{variant:"outline-secondary",disabled:t.loading},on:{click:t.goBack}},[t._v(" Back to POS ")])],1),n("b-card",{staticClass:"mb-4"},[n("h5",{staticClass:"mb-3"},[t._v("Enter Ticket Number")]),n("b-row",[n("b-col",{attrs:{cols:"12",md:"6"}},[n("b-input-group",[n("b-form-input",{ref:"ticketInput",attrs:{placeholder:"Enter ticket number...",disabled:t.loading},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadTicket(e)}},model:{value:t.ticketNumber,callback:function(e){t.ticketNumber=e},expression:"ticketNumber"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"primary",disabled:t.loading||!t.ticketNumber},on:{click:t.loadTicket}},[t.loading?n("b-spinner",{staticClass:"mr-1",attrs:{small:""}}):n("feather-icon",{attrs:{icon:"SearchIcon"}}),t._v(" Load Ticket ")],1)],1)],1)],1)],1)],1),t.ticketData?n("b-card",{staticClass:"mb-4 ticket-details-card"},[n("div",{staticClass:"d-flex align-items-center mb-3"},[n("feather-icon",{staticClass:"mr-2 text-primary",attrs:{icon:"FileTextIcon",size:"20"}}),n("h5",{staticClass:"mb-0"},[t._v("Ticket Details")])],1),n("b-row",[n("b-col",{attrs:{cols:"12",md:"6"}},[n("div",{staticClass:"detail-item"},[n("strong",{staticClass:"detail-label"},[t._v("Ticket Number:")]),n("span",{staticClass:"detail-value"},[t._v(t._s(t.ticketData.ticket.salesNumber))])]),n("div",{staticClass:"detail-item"},[n("strong",{staticClass:"detail-label"},[t._v("Date:")]),n("span",{staticClass:"detail-value"},[t._v(t._s(t.formatDate(t.ticketData.ticket.salesDate)))])]),t.ticketData.ticket.customer?n("div",{staticClass:"detail-item"},[n("strong",{staticClass:"detail-label"},[t._v("Customer:")]),n("span",{staticClass:"detail-value"},[t._v(t._s(t.ticketData.ticket.customer.name))]),n("small",{staticClass:"text-muted ml-2"},[t._v("("+t._s(t.ticketData.ticket.customer.customerCode)+")")])]):t._e(),t.ticketData.ticket.createdByUser?n("div",{staticClass:"detail-item"},[n("strong",{staticClass:"detail-label"},[t._v("Cashier:")]),n("span",{staticClass:"detail-value"},[t._v(t._s(t.ticketData.ticket.createdByUser.fullName||t.ticketData.ticket.createdByUser.username))])]):t._e()]),n("b-col",{attrs:{cols:"12",md:"6"}},[n("div",{staticClass:"ticket-summary"},[t.ticketData.ticket.subtotal?n("div",{staticClass:"summary-item"},[n("span",{staticClass:"summary-label"},[t._v("Subtotal:")]),n("span",{staticClass:"summary-value"},[t._v(t._s(t.formatPrice(t.ticketData.ticket.subtotal))+" TND")])]):t._e(),t.ticketData.ticket.taxAmount?n("div",{staticClass:"summary-item"},[n("span",{staticClass:"summary-label"},[t._v("Tax (VAT):")]),n("span",{staticClass:"summary-value"},[t._v(t._s(t.formatPrice(t.ticketData.ticket.taxAmount))+" TND")])]):t._e(),t.ticketData.ticket.discountAmount?n("div",{staticClass:"summary-item"},[n("span",{staticClass:"summary-label"},[t._v("Discount:")]),n("span",{staticClass:"summary-value text-danger"},[t._v("-"+t._s(t.formatPrice(t.ticketData.ticket.discountAmount))+" TND")])]):t._e(),n("div",{staticClass:"summary-item total-amount"},[n("span",{staticClass:"summary-label"},[n("strong",[t._v("Total Amount (TTC):")])]),n("span",{staticClass:"summary-value"},[n("strong",[t._v(t._s(t.formatPrice(t.ticketData.ticket.totalAmount))+" TND")])])])]),t.ticketData.canReturn?t._e():n("div",{staticClass:"detail-item mt-2"},[n("b-badge",{attrs:{variant:"danger"}},[t._v("This ticket is too old to be returned")])],1)])],1)],1):t._e(),t.ticketData&&t.ticketData.canReturn?n("b-card",{staticClass:"mb-4 return-items-card"},[n("div",{staticClass:"d-flex align-items-center mb-3"},[n("feather-icon",{staticClass:"mr-2 text-primary",attrs:{icon:"PackageIcon",size:"20"}}),n("h5",{staticClass:"mb-0"},[t._v("Select Items to Return")])],1),n("b-table",{staticClass:"return-items-table",attrs:{items:t.ticketData.salesLines,fields:t.lineFields,striped:"",hover:"",responsive:""},scopedSlots:t._u([{key:"cell(item)",fn:function(e){return[n("div",[n("strong",[t._v(t._s(e.item.item.name))]),n("div",{staticClass:"small text-muted"},[t._v(t._s(e.item.item.itemCode))])])]}},{key:"cell(originalQty)",fn:function(e){return[n("span",{staticClass:"badge badge-secondary"},[t._v(t._s(e.item.quantity))])]}},{key:"cell(remainingQty)",fn:function(e){return[n("span",{staticClass:"font-weight-bold",class:t.getRemainingQtyClass(e.item)},[t._v(" "+t._s(void 0!==e.item.remainingQuantity?e.item.remainingQuantity:e.item.quantity)+" ")]),e.item.returnedQuantity>0?n("div",{staticClass:"small text-muted"},[t._v(" ("+t._s(e.item.returnedQuantity)+" already returned) ")]):t._e()]}},{key:"cell(unitPrice)",fn:function(e){return[n("div",[n("strong",[t._v(t._s(t.formatPrice(e.item.unitPriceIncludingVat||e.item.unitPrice))+" TND")]),e.item.vatPercent?n("div",{staticClass:"small text-muted"},[n("span",{staticClass:"text-info"},[t._v("VAT: "+t._s(e.item.vatPercent)+"%")])]):t._e(),e.item.unitPriceIncludingVat&&e.item.unitPrice?n("div",{staticClass:"small text-muted"},[n("span",{staticClass:"text-muted"},[t._v("HT: "+t._s(t.formatPrice(e.item.unitPrice))+" TND")])]):t._e()])]}},{key:"cell(returnQty)",fn:function(e){return[n("b-form-input",{staticClass:"return-qty-input",staticStyle:{width:"100px"},attrs:{type:"number",min:0,max:e.item.remainingQuantity||e.item.quantity,disabled:t.loading,state:t.getReturnQtyState(e.item)},on:{input:function(n){return t.onReturnQuantityChange(e.item)},blur:function(n){return t.onReturnQuantityBlur(e.item)},keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.onReturnQuantityBlur(e.item)}},model:{value:e.item.returnQuantity,callback:function(n){t.$set(e.item,"returnQuantity",t._n(n))},expression:"row.item.returnQuantity"}}),e.item.returnQuantity>(e.item.remainingQuantity||e.item.quantity)?n("b-form-invalid-feedback",{attrs:{state:!1}},[t._v(" Cannot exceed "+t._s(void 0!==e.item.remainingQuantity?e.item.remainingQuantity:e.item.quantity)+" ")]):t._e()]}},{key:"cell(returnAmount)",fn:function(e){return[n("div",[n("strong",{staticClass:"text-success"},[t._v(t._s(t.formatPrice(t.getReturnAmount(e.item)))+" TND")]),e.item.vatAmount&&e.item.returnQuantity>0?n("div",{staticClass:"small text-muted"},[n("span",{staticClass:"text-info"},[t._v("VAT: "+t._s(t.formatPrice(e.item.vatAmount/e.item.quantity*e.item.returnQuantity))+" TND")])]):t._e()])]}}],null,!1,3139184715)})],1):t._e(),t.ticketData&&t.ticketData.canReturn&&t.hasReturnItems?n("b-card",{staticClass:"mb-4"},[n("h5",{staticClass:"mb-3"},[t._v("Return Type")]),n("b-form-group",[n("b-form-radio-group",{attrs:{options:t.returnTypeOptions},on:{change:t.onReturnTypeChange},model:{value:t.returnType,callback:function(e){t.returnType=e},expression:"returnType"}})],1),"SIMPLE_RETURN"!==t.returnType||t.ticketData.isSimpleReturnEnabled?t._e():n("b-alert",{attrs:{variant:"warning",show:""}},[t._v(" Simple return is not enabled. Please select Return Voucher. ")])],1):t._e(),t.ticketData&&t.ticketData.canReturn&&t.hasReturnItems?n("b-card",{staticClass:"mb-4 return-summary-card"},[n("div",{staticClass:"d-flex align-items-center mb-3"},[n("feather-icon",{staticClass:"mr-2 text-primary",attrs:{icon:"CalculatorIcon",size:"20"}}),n("h5",{staticClass:"mb-0"},[t._v("Return Summary")])],1),n("b-row",[n("b-col",{attrs:{cols:"12",md:"6","offset-md":"6"}},[n("div",{staticClass:"return-summary"},[n("div",{staticClass:"summary-row"},[n("span",{staticClass:"summary-label"},[t._v("Subtotal (HT):")]),n("span",{staticClass:"summary-value"},[t._v(t._s(t.formatPrice(t.totalReturnAmountHT))+" TND")])]),t.totalReturnVAT>0?n("div",{staticClass:"summary-row"},[n("span",{staticClass:"summary-label"},[t._v("Tax (VAT):")]),n("span",{staticClass:"summary-value text-info"},[t._v(t._s(t.formatPrice(t.totalReturnVAT))+" TND")])]):t._e(),n("div",{staticClass:"summary-row total-return"},[n("span",{staticClass:"summary-label"},[n("strong",[t._v("Total Return Amount (TTC):")])]),n("span",{staticClass:"summary-value"},[n("strong",{staticClass:"text-success"},[t._v(t._s(t.formatPrice(t.totalReturnAmount))+" TND")])])])])])],1)],1):t._e(),t.ticketData&&t.ticketData.canReturn&&t.hasReturnItems?n("div",{staticClass:"text-center"},[n("b-button",{attrs:{variant:"success",size:"lg",disabled:t.loading||!t.canProcessReturn},on:{click:t.processReturn}},[t.loading?n("b-spinner",{staticClass:"mr-2",attrs:{small:""}}):n("feather-icon",{staticClass:"mr-2",attrs:{icon:"CheckCircleIcon",size:"18"}}),t._v(" Process Return ")],1)],1):t._e()],1)},r=[],i=n("b85c"),s=n("c7eb"),u=n("1da1"),c=(n("99af"),n("a15b9"),n("d81d"),n("13d5"),n("b0c0"),n("b680"),n("d3b7"),n("498a"),n("159b"),n("223c")),o=n("475a"),l=n("62c5"),m=n.n(l),d={name:"ReturnProducts",data:function(){return{ticketNumber:"",ticketData:null,returnType:"RETURN_VOUCHER",loading:!1,lineFields:[{key:"item",label:"Item"},{key:"originalQty",label:"Purchased Qty",thClass:"text-center",tdClass:"text-center"},{key:"remainingQty",label:"Remaining Qty",thClass:"text-center",tdClass:"text-center"},{key:"unitPrice",label:"Unit Price (TTC)",thClass:"text-right",tdClass:"text-right"},{key:"returnQty",label:"Return Qty",thClass:"text-center",tdClass:"text-center"},{key:"returnAmount",label:"Return Amount (TTC)",thClass:"text-right",tdClass:"text-right"}]}},computed:{returnTypeOptions:function(){var t=[];return this.ticketData&&this.ticketData.isSimpleReturnEnabled&&t.push({value:"SIMPLE_RETURN",text:"Simple Return (Cash Refund)"}),t.push({value:"RETURN_VOUCHER",text:"Return Voucher"}),t},hasReturnItems:function(){if(!this.ticketData||!this.ticketData.salesLines)return!1;var t=this.ticketData.salesLines.some((function(t){var e=parseFloat(t.returnQuantity);if(isNaN(e)||null===e||void 0===e)return!1;var n=Math.round(e);return n>0&&n<=t.quantity}));return t},totalReturnAmount:function(){return this.ticketData&&this.ticketData.salesLines?this.ticketData.salesLines.reduce((function(t,e){var n=parseFloat(e.returnQuantity)||0,a=void 0!==e.remainingQuantity?e.remainingQuantity:e.quantity;n>a&&(n=a),n<0&&(n=0),n=Math.round(n);var r=e.unitPriceIncludingVat||e.unitPrice;return t+n*r}),0):0},totalReturnAmountHT:function(){return this.ticketData&&this.ticketData.salesLines?this.ticketData.salesLines.reduce((function(t,e){var n=parseFloat(e.returnQuantity)||0,a=void 0!==e.remainingQuantity?e.remainingQuantity:e.quantity;n>a&&(n=a),n<0&&(n=0),n=Math.round(n);var r=e.unitPrice||0;return t+n*r}),0):0},totalReturnVAT:function(){return this.totalReturnAmount-this.totalReturnAmountHT},canProcessReturn:function(){return!!this.hasReturnItems&&!("SIMPLE_RETURN"===this.returnType&&!this.ticketData.isSimpleReturnEnabled)}},mounted:function(){var t=this;this.$nextTick((function(){t.$refs.ticketInput&&t.$refs.ticketInput.focus()}))},methods:{loadTicket:function(){var t=this;return Object(u["a"])(Object(s["a"])().mark((function e(){var n,a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.ticketNumber.trim()){e.next=3;break}return t.$toast({component:c["default"],props:{title:"Error",icon:"XIcon",text:"Please enter a ticket number",variant:"danger"}}),e.abrupt("return");case 3:return t.loading=!0,e.prev=4,e.next=7,t.$http.get("/return-header/ticket-details",{params:{ticketNumber:t.ticketNumber.trim()}});case 7:n=e.sent,200===n.status&&(t.ticketData=n.data,t.ticketData.salesLines&&t.ticketData.salesLines.forEach((function(e){t.$set(e,"returnQuantity",0),void 0===e.remainingQuantity&&t.$set(e,"remainingQuantity",e.quantity)})),t.ticketData.isSimpleReturnEnabled||(t.returnType="RETURN_VOUCHER")),e.next=18;break;case 11:e.prev=11,e.t0=e["catch"](4),console.error("Error loading ticket:",e.t0),a="Failed to load ticket. Please check the ticket number.",e.t0.response&&e.t0.response.data&&(a=e.t0.response.data.message||e.t0.response.data||a),t.$toast({component:c["default"],props:{title:"Error",icon:"XIcon",text:a,variant:"danger"}}),t.ticketData=null;case 18:return e.prev=18,t.loading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[4,11,18,21]])})))()},onReturnQuantityChange:function(t){var e=this,n=parseFloat(t.returnQuantity);(isNaN(n)||null===n||void 0===n)&&(n=0);var a=void 0!==t.remainingQuantity?t.remainingQuantity:t.quantity;n>a&&(n=a,this.$nextTick((function(){e.$toast({component:c["default"],props:{title:"Validation",icon:"AlertCircleIcon",text:"Return quantity cannot exceed remaining quantity (".concat(a,")"),variant:"warning"}})}))),n<0&&(n=0),n=Math.round(n),this.$set(t,"returnQuantity",n)},onReturnQuantityBlur:function(t){var e=parseFloat(t.returnQuantity);(isNaN(e)||null===e||void 0===e)&&(e=0);var n=void 0!==t.remainingQuantity?t.remainingQuantity:t.quantity;e>n&&(e=n),e<0&&(e=0),e=Math.round(e),this.$set(t,"returnQuantity",e)},getReturnQtyState:function(t){if(null===t.returnQuantity||void 0===t.returnQuantity)return null;var e=parseFloat(t.returnQuantity);if(isNaN(e))return!1;var n=void 0!==t.remainingQuantity?t.remainingQuantity:t.quantity;return!(e<0||e>n)&&null},getReturnAmount:function(t){var e=parseFloat(t.returnQuantity)||0,n=void 0!==t.remainingQuantity?t.remainingQuantity:t.quantity;e>n&&(e=n),e<0&&(e=0),e=Math.round(e);var a=t.unitPriceIncludingVat||t.unitPrice;return e*a},getRemainingQtyClass:function(t){var e=void 0!==t.remainingQuantity?t.remainingQuantity:t.quantity;return 0===e?"text-danger":e<t.quantity?"text-warning":"text-success"},onReturnTypeChange:function(){},processReturn:function(){var t=this;return Object(u["a"])(Object(s["a"])().mark((function e(){var n,a,r,u,o,l,m,d,p,f;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.canProcessReturn){e.next=2;break}return e.abrupt("return");case 2:n=[],a=[],r=Object(i["a"])(t.ticketData.salesLines),e.prev=5,r.s();case 7:if((u=r.n()).done){e.next=24;break}if(o=u.value,l=parseFloat(o.returnQuantity)||0,!isNaN(l)){e.next=13;break}return n.push("Invalid return quantity for ".concat(o.item.name)),e.abrupt("continue",22);case 13:if(l=Math.round(l),!(l<0)){e.next=17;break}return n.push("Return quantity for ".concat(o.item.name," cannot be negative")),e.abrupt("continue",22);case 17:if(m=void 0!==o.remainingQuantity?o.remainingQuantity:o.quantity,!(l>m)){e.next=21;break}return n.push("Return quantity for ".concat(o.item.name," (").concat(l,") cannot exceed remaining quantity (").concat(m,")")),e.abrupt("continue",22);case 21:l>0&&a.push({salesLineId:o.id,quantity:l});case 22:e.next=7;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e["catch"](5),r.e(e.t0);case 29:return e.prev=29,r.f(),e.finish(29);case 32:if(!(n.length>0)){e.next=35;break}return t.$toast({component:c["default"],props:{title:"Validation Error",icon:"XIcon",text:n.join(". "),variant:"danger"}}),e.abrupt("return");case 35:if(0!==a.length){e.next=38;break}return t.$toast({component:c["default"],props:{title:"Error",icon:"XIcon",text:"Please select at least one item to return",variant:"danger"}}),e.abrupt("return");case 38:return t.loading=!0,e.prev=39,d={ticketNumber:t.ticketNumber.trim(),returnType:t.returnType,returnLines:a,notes:""},e.next=43,t.$http.post("/return-header/process-return",d);case 43:p=e.sent,200===p.status&&(t.$toast({component:c["default"],props:{title:"Success",icon:"CheckCircleIcon",text:"Return ".concat(p.data.returnNumber," processed successfully!"),variant:"success"}}),"RETURN_VOUCHER"===t.returnType&&p.data.returnVoucher&&(t.$toast({component:c["default"],props:{title:"Return Voucher Created",icon:"FileTextIcon",text:"Voucher Number: ".concat(p.data.returnVoucher.voucherNumber,", Amount: ").concat(t.formatPrice(p.data.returnVoucher.voucherAmount)," TND"),variant:"info"}}),t.printVoucherReceipt(p.data)),setTimeout((function(){t.ticketNumber="",t.ticketData=null,t.returnType="RETURN_VOUCHER",t.$refs.ticketInput&&t.$refs.ticketInput.focus()}),2e3)),e.next=53;break;case 47:e.prev=47,e.t1=e["catch"](39),console.error("Error processing return:",e.t1),f="Failed to process return. Please try again.",e.t1.response&&e.t1.response.data&&(f=e.t1.response.data.message||e.t1.response.data||f),t.$toast({component:c["default"],props:{title:"Error",icon:"XIcon",text:f,variant:"danger"}});case 53:return e.prev=53,t.loading=!1,e.finish(53);case 56:case"end":return e.stop()}}),e,null,[[5,26,29,32],[39,47,53,56]])})))()},formatDate:function(t){if(!t)return"-";var e=new Date(t);return e.toLocaleString()},formatPrice:function(t){return t?parseFloat(t).toFixed(2):"0.00"},goBack:function(){this.$router.push({name:"pos-item-selection"})},printVoucherReceipt:function(t){var e=this;return Object(u["a"])(Object(s["a"])().mark((function n(){var a,r,i,u,l,d,p,f,b,v;return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t&&t.returnVoucher){n.next=3;break}return console.error("No voucher data to print"),n.abrupt("return");case 3:if(i=t.returnLines||[],u={salesNumber:t.returnVoucher.voucherNumber,salesDate:t.returnVoucher.voucherDate,totalAmount:t.returnVoucher.voucherAmount,subtotal:t.returnVoucher.voucherAmount,taxAmount:0,discountAmount:0,paidAmount:t.returnVoucher.voucherAmount,changeAmount:0,notes:"Return Voucher - Original Ticket: ".concat((null===(a=t.originalSalesHeader)||void 0===a?void 0:a.salesNumber)||"N/A"),createdByUser:{fullName:"System",username:"System"},cashierSession:null,customer:t.returnVoucher.customerName?{name:t.returnVoucher.customerName}:null,salesLines:i.map((function(t){var e,n;return{item:{name:(null===(e=t.item)||void 0===e?void 0:e.name)||"Return Item",itemCode:(null===(n=t.item)||void 0===n?void 0:n.itemCode)||"N/A"},quantity:t.quantity||0,lineTotal:(t.unitPrice||0)*(t.quantity||0),unitPrice:t.unitPrice||0}})),paymentHeaders:[{paymentMethod:{name:"Return Voucher"},totalAmount:t.returnVoucher.voucherAmount,paymentReference:t.returnVoucher.voucherNumber}]},u.isVoucher=!0,u.voucherInfo={voucherNumber:t.returnVoucher.voucherNumber,expiryDate:t.returnVoucher.expiryDate,originalTicket:(null===(r=t.originalSalesHeader)||void 0===r?void 0:r.salesNumber)||"N/A",returnNumber:t.returnNumber},console.log("Printing voucher receipt with data:",u),l=e.$root.constructor||e.$options._base,d=l.extend(o["a"]),p=new d({parent:e,propsData:{saleData:u,isVoucher:!0}}),p.$mount(),f=window.open("","_blank"),f){n.next=16;break}return e.$toast({component:c["default"],props:{title:"Print Error",icon:"XIcon",text:"Please allow popups to print vouchers",variant:"warning"}}),n.abrupt("return");case 16:return n.next=18,e.$nextTick();case 18:return n.next=20,new Promise((function(t){return setTimeout(t,200)}));case 20:if(b=t.returnVoucher.voucherNumber||null,b&&p.$el)try{v=p.$el.querySelector(".barcode-svg"),v&&m()(v,b,{format:"CODE128",width:1.5,height:40,displayValue:!1,margin:5,background:"#ffffff",lineColor:"#000000"})}catch(s){console.error("Error generating barcode:",s)}f.document.write("\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Return Voucher - ".concat(t.returnVoucher.voucherNumber,"</title>\n          <style>\n            @page {\n              size: 80mm auto;\n              margin: 0;\n            }\n            body {\n              margin: 0;\n              padding: 10mm;\n              font-family: 'Courier New', monospace;\n              font-size: 12px;\n              line-height: 1.4;\n              background: white;\n              color: black;\n            }\n            .receipt-template {\n              width: 100%;\n              max-width: 80mm;\n            }\n            .receipt-header { margin-bottom: 15px; }\n            .receipt-header h2 { font-size: 16px; margin: 5px 0; font-weight: bold; text-align: center; }\n            .receipt-header h3 { font-size: 14px; margin: 5px 0; font-weight: bold; text-align: center; }\n            .receipt-divider { margin: 8px 0; text-align: center; }\n            .receipt-info, .receipt-items, .receipt-totals, .receipt-payments { margin-bottom: 10px; }\n            .receipt-row { display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 12px; }\n            .receipt-row.total { font-weight: bold; font-size: 14px; margin-top: 8px; }\n            .receipt-row .label { text-align: left; }\n            .receipt-row .value { text-align: right; font-weight: bold; }\n            .item-name { flex: 2; text-align: left; }\n            .item-qty { flex: 0.5; text-align: center; }\n            .item-total { flex: 1; text-align: right; }\n            .item-code { font-size: 10px; color: #666; margin-left: 10px; margin-bottom: 6px; }\n            .receipt-section-header { font-weight: bold; text-align: center; margin: 8px 0; }\n            .receipt-footer { margin-top: 20px; text-align: center; font-size: 11px; }\n            .receipt-item { margin-bottom: 8px; }\n            .payment-entry { margin-bottom: 8px; }\n            .voucher-badge {\n              background: #007bff;\n              color: white;\n              font-weight: bold;\n              text-align: center;\n              padding: 8px;\n              margin: 10px 0;\n              font-size: 14px;\n              border: 2px solid #000;\n            }\n            .receipt-barcode { margin: 15px 0; text-align: center; }\n            .barcode-container { display: flex; justify-content: center; align-items: center; margin: 10px 0; }\n            .barcode-svg { max-width: 100%; height: auto; }\n            .barcode-text { font-size: 11px; font-weight: bold; margin-top: 5px; letter-spacing: 1px; text-align: center; }\n          </style>\n        </head>\n        <body>\n          ").concat(p.$el.outerHTML,"\n        </body>\n        </html>\n      ")),f.document.close(),setTimeout((function(){f.focus(),f.print(),setTimeout((function(){f.close(),p&&p.$el&&p.$destroy()}),1e3)}),500);case 25:case"end":return n.stop()}}),n)})))()}}},p=d,f=(n("eaf5"),n("2877")),b=Object(f["a"])(p,a,r,!1,null,"32cca83c",null);e["default"]=b.exports},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");var a=n("06c5");function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,u=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){c=!0,s=t},f:function(){try{u||null==n["return"]||n["return"]()}finally{if(c)throw s}}}}},d58f:function(t,e,n){var a=n("1c0b"),r=n("7b0b"),i=n("44ad"),s=n("50c4"),u=function(t){return function(e,n,u,c){a(n);var o=r(e),l=i(o),m=s(o.length),d=t?m-1:0,p=t?-1:1;if(u<2)while(1){if(d in l){c=l[d],d+=p;break}if(d+=p,t?d<0:m<=d)throw TypeError("Reduce of empty array with no initial value")}for(;t?d>=0:m>d;d+=p)d in l&&(c=n(c,l[d],d,o));return c}};t.exports={left:u(!1),right:u(!0)}},eaf5:function(t,e,n){"use strict";n("594e")}}]);
//# sourceMappingURL=chunk-71903056.3380fd62.js.map