{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.reduce.js","webpack:///./src/@core/components/toastification/ToastificationContent.vue?0408","webpack:///src/@core/components/toastification/ToastificationContent.vue","webpack:///./src/@core/components/toastification/ToastificationContent.vue?5e2e","webpack:///./src/@core/components/toastification/ToastificationContent.vue","webpack:///./src/@core/components/toastification/ToastificationContent.vue?b3fb","webpack:///./src/views/pos/ReturnProducts.vue?0053","webpack:///src/views/pos/ReturnProducts.vue","webpack:///./src/views/pos/ReturnProducts.vue?3501","webpack:///./src/views/pos/ReturnProducts.vue?23d8","webpack:///./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","webpack:///./node_modules/core-js/internals/array-reduce.js","webpack:///./src/views/pos/ReturnProducts.vue?936c"],"names":["$","$reduce","left","arrayMethodIsStrict","arrayMethodUsesToLength","CHROME_VERSION","IS_NODE","STRICT_METHOD","USES_TO_LENGTH","1","CHROME_BUG","target","proto","forced","reduce","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","variant","icon","class","domProps","_s","title","_e","text","on","$event","$emit","hideClose","staticRenderFns","components","BAvatar","props","type","String","default","Boolean","component","_v","loading","goBack","ref","indexOf","_k","keyCode","key","loadTicket","model","value","callback","$$v","ticketNumber","expression","ticketData","ticket","salesNumber","formatDate","salesDate","customer","name","customerCode","createdByUser","fullName","username","formatPrice","subtotal","taxAmount","discountAmount","totalAmount","canReturn","salesLines","lineFields","scopedSlots","_u","fn","row","item","itemCode","quantity","getRemainingQtyClass","remainingQuantity","returnedQuantity","unitPriceIncludingVat","unitPrice","vatPercent","staticStyle","getReturnQtyState","onReturnQuantityChange","onReturnQuantityBlur","$set","_n","returnQuantity","getReturnAmount","vatAmount","hasReturnItems","returnTypeOptions","onReturnTypeChange","returnType","isSimpleReturnEnabled","totalReturnAmountHT","totalReturnVAT","totalReturnAmount","canProcessReturn","processReturn","data","label","thClass","tdClass","computed","options","push","hasItems","some","line","qty","parseFloat","isNaN","roundedQty","Math","round","total","returnQty","maxReturnable","unitPriceTTC","unitPriceHT","mounted","_this","$nextTick","$refs","ticketInput","focus","methods","_this2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","errorMessage","wrap","_context","prev","next","trim","$toast","ToastificationContent","abrupt","$http","get","params","sent","status","forEach","t0","console","error","message","finish","stop","_this3","concat","remaining","_this4","_callee2","validationErrors","returnLines","_iterator","_step","request","_context2","_createForOfIteratorHelper","s","n","done","salesLineId","id","e","f","join","notes","post","returnNumber","returnVoucher","voucherNumber","voucherAmount","printVoucherReceipt","setTimeout","t1","dateStr","date","Date","toLocaleString","price","toFixed","$router","returnData","_this5","_callee3","_returnData$originalS","_returnData$originalS2","voucherData","Vue","ReceiptComponent","instance","printWindow","barcodeValue","svgElement","_context3","voucherDate","paidAmount","changeAmount","originalSalesHeader","cashierSession","customerName","map","_line$item","_line$item2","lineTotal","paymentHeaders","paymentMethod","paymentReference","isVoucher","voucherInfo","expiryDate","originalTicket","log","$root","constructor","$options","_base","extend","ReceiptTemplate","parent","propsData","saleData","$mount","window","open","Promise","resolve","$el","querySelector","JsBarcode","format","width","height","displayValue","margin","background","lineColor","document","write","outerHTML","close","print","$destroy","r","t","Symbol","iterator","Array","isArray","unsupportedIterableToArray","F","TypeError","o","a","u","call","aFunction","toObject","IndexedObject","toLength","createMethod","IS_RIGHT","that","argumentsLength","memo","O","self","index","i","module","exports","right"],"mappings":"kHACA,IAAIA,EAAI,EAAQ,QACZC,EAAU,EAAQ,QAA6BC,KAC/CC,EAAsB,EAAQ,QAC9BC,EAA0B,EAAQ,QAClCC,EAAiB,EAAQ,QACzBC,EAAU,EAAQ,QAElBC,EAAgBJ,EAAoB,UACpCK,EAAiBJ,EAAwB,SAAU,CAAEK,EAAG,IAGxDC,GAAcJ,GAAWD,EAAiB,IAAMA,EAAiB,GAIrEL,EAAE,CAAEW,OAAQ,QAASC,OAAO,EAAMC,QAASN,IAAkBC,GAAkBE,GAAc,CAC3FI,OAAQ,SAAgBC,GACtB,OAAOd,EAAQe,KAAMD,EAAYE,UAAUC,OAAQD,UAAUC,OAAS,EAAID,UAAU,QAAKE,O,oEClB7F,IAAIC,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,MAAM,CAACE,YAAY,4BAA4B,CAACF,EAAG,WAAW,CAACE,YAAY,sBAAsBC,MAAM,CAAC,QAAUN,EAAIO,QAAQ,KAAO,WAAW,CAACJ,EAAG,eAAe,CAACG,MAAM,CAAC,KAAON,EAAIQ,KAAK,KAAO,SAAS,GAAGL,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,MAAM,CAAEH,EAAS,MAAEG,EAAG,KAAK,CAACE,YAAY,+CAA+CI,MAAO,QAAUT,EAAIO,QAASG,SAAS,CAAC,YAAcV,EAAIW,GAAGX,EAAIY,UAAUZ,EAAIa,KAAMb,EAAQ,KAAEG,EAAG,QAAQ,CAACE,YAAY,2BAA2BK,SAAS,CAAC,YAAcV,EAAIW,GAAGX,EAAIc,SAASd,EAAIa,OAAOV,EAAG,OAAO,CAACE,YAAY,oDAAoDU,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOhB,EAAIiB,MAAM,kBAAkB,CAAGjB,EAAIkB,UAA+ElB,EAAIa,KAAxEV,EAAG,eAAe,CAACE,YAAY,YAAYC,MAAM,CAAC,KAAO,YAAqB,MAAM,MACv5Ba,EAAkB,G,YC4CP,GACfC,WAAA,CACAC,gBAEAC,MAAA,CACAf,QAAA,CACAgB,KAAAC,OACAC,QAAA,WAEAjB,KAAA,CACAe,KAAAC,OACAC,QAAA,MAEAb,MAAA,CACAW,KAAAC,OACAC,QAAA,MAEAX,KAAA,CACAS,KAAAC,OACAC,QAAA,MAEAP,UAAA,CACAK,KAAAG,QACAD,SAAA,KCpE4X,I,wBCQxXE,EAAY,eACd,EACA5B,EACAoB,GACA,EACA,KACA,WACA,MAIa,aAAAQ,E,6CCnBf,W,oECAA,IAAI5B,EAAS,WAAa,IAAIC,EAAIL,KAASM,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,6BAA6B,CAACF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACL,EAAI4B,GAAG,qBAAqBzB,EAAG,WAAW,CAACG,MAAM,CAAC,QAAU,oBAAoB,SAAWN,EAAI6B,SAASd,GAAG,CAAC,MAAQf,EAAI8B,SAAS,CAAC9B,EAAI4B,GAAG,oBAAoB,GAAGzB,EAAG,SAAS,CAACE,YAAY,QAAQ,CAACF,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACL,EAAI4B,GAAG,yBAAyBzB,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,MAAM,CAACH,EAAG,gBAAgB,CAACA,EAAG,eAAe,CAAC4B,IAAI,cAAczB,MAAM,CAAC,YAAc,yBAAyB,SAAWN,EAAI6B,SAASd,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAIA,EAAOO,KAAKS,QAAQ,QAAQhC,EAAIiC,GAAGjB,EAAOkB,QAAQ,QAAQ,GAAGlB,EAAOmB,IAAI,SAAkB,KAAcnC,EAAIoC,WAAWpB,KAAUqB,MAAM,CAACC,MAAOtC,EAAgB,aAAEuC,SAAS,SAAUC,GAAMxC,EAAIyC,aAAaD,GAAKE,WAAW,kBAAkBvC,EAAG,uBAAuB,CAACA,EAAG,WAAW,CAACG,MAAM,CAAC,QAAU,UAAU,SAAWN,EAAI6B,UAAY7B,EAAIyC,cAAc1B,GAAG,CAAC,MAAQf,EAAIoC,aAAa,CAAEpC,EAAW,QAAEG,EAAG,YAAY,CAACE,YAAY,OAAOC,MAAM,CAAC,MAAQ,MAAMH,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,gBAAgBN,EAAI4B,GAAG,kBAAkB,IAAI,IAAI,IAAI,IAAI,IAAI,GAAI5B,EAAc,WAAEG,EAAG,SAAS,CAACE,YAAY,4BAA4B,CAACF,EAAG,MAAM,CAACE,YAAY,kCAAkC,CAACF,EAAG,eAAe,CAACE,YAAY,oBAAoBC,MAAM,CAAC,KAAO,eAAe,KAAO,QAAQH,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACL,EAAI4B,GAAG,qBAAqB,GAAGzB,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,MAAM,CAACH,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG,oBAAoBzB,EAAG,OAAO,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAI2C,WAAWC,OAAOC,kBAAkB1C,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG,WAAWzB,EAAG,OAAO,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAI8C,WAAW9C,EAAI2C,WAAWC,OAAOG,iBAAkB/C,EAAI2C,WAAWC,OAAe,SAAEzC,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG,eAAezB,EAAG,OAAO,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAI2C,WAAWC,OAAOI,SAASC,SAAS9C,EAAG,QAAQ,CAACE,YAAY,mBAAmB,CAACL,EAAI4B,GAAG,IAAI5B,EAAIW,GAAGX,EAAI2C,WAAWC,OAAOI,SAASE,cAAc,SAASlD,EAAIa,KAAMb,EAAI2C,WAAWC,OAAoB,cAAEzC,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG,cAAczB,EAAG,OAAO,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAI2C,WAAWC,OAAOO,cAAcC,UAAYpD,EAAI2C,WAAWC,OAAOO,cAAcE,eAAerD,EAAIa,OAAOV,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,MAAM,CAACH,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAAEL,EAAI2C,WAAWC,OAAe,SAAEzC,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG,eAAezB,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAI2C,WAAWC,OAAOW,WAAW,YAAYvD,EAAIa,KAAMb,EAAI2C,WAAWC,OAAgB,UAAEzC,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG,gBAAgBzB,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAI2C,WAAWC,OAAOY,YAAY,YAAYxD,EAAIa,KAAMb,EAAI2C,WAAWC,OAAqB,eAAEzC,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG,eAAezB,EAAG,OAAO,CAACE,YAAY,6BAA6B,CAACL,EAAI4B,GAAG,IAAI5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAI2C,WAAWC,OAAOa,iBAAiB,YAAYzD,EAAIa,KAAKV,EAAG,MAAM,CAACE,YAAY,6BAA6B,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACF,EAAG,SAAS,CAACH,EAAI4B,GAAG,2BAA2BzB,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACF,EAAG,SAAS,CAACH,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAI2C,WAAWC,OAAOc,cAAc,gBAAkB1D,EAAI2C,WAAWgB,UAAuJ3D,EAAIa,KAAhJV,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,UAAU,CAACG,MAAM,CAAC,QAAU,WAAW,CAACN,EAAI4B,GAAG,4CAA4C,MAAe,IAAI,GAAG5B,EAAIa,KAAMb,EAAI2C,YAAc3C,EAAI2C,WAAWgB,UAAWxD,EAAG,SAAS,CAACE,YAAY,0BAA0B,CAACF,EAAG,MAAM,CAACE,YAAY,kCAAkC,CAACF,EAAG,eAAe,CAACE,YAAY,oBAAoBC,MAAM,CAAC,KAAO,cAAc,KAAO,QAAQH,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACL,EAAI4B,GAAG,6BAA6B,GAAGzB,EAAG,UAAU,CAACE,YAAY,qBAAqBC,MAAM,CAAC,MAAQN,EAAI2C,WAAWiB,WAAW,OAAS5D,EAAI6D,WAAW,QAAU,GAAG,MAAQ,GAAG,WAAa,IAAIC,YAAY9D,EAAI+D,GAAG,CAAC,CAAC5B,IAAI,aAAa6B,GAAG,SAASC,GAAK,MAAO,CAAC9D,EAAG,MAAM,CAACA,EAAG,SAAS,CAACH,EAAI4B,GAAG5B,EAAIW,GAAGsD,EAAIC,KAAKA,KAAKjB,SAAS9C,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGsD,EAAIC,KAAKA,KAAKC,kBAAkB,CAAChC,IAAI,oBAAoB6B,GAAG,SAASC,GAAK,MAAO,CAAC9D,EAAG,OAAO,CAACE,YAAY,yBAAyB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGsD,EAAIC,KAAKE,gBAAgB,CAACjC,IAAI,qBAAqB6B,GAAG,SAASC,GAAK,MAAO,CAAC9D,EAAG,OAAO,CAACE,YAAY,mBAAmBI,MAAMT,EAAIqE,qBAAqBJ,EAAIC,OAAO,CAAClE,EAAI4B,GAAG,IAAI5B,EAAIW,QAAkCb,IAA/BmE,EAAIC,KAAKI,kBAAkCL,EAAIC,KAAKI,kBAAoBL,EAAIC,KAAKE,UAAU,OAAQH,EAAIC,KAAKK,iBAAmB,EAAGpE,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACL,EAAI4B,GAAG,KAAK5B,EAAIW,GAAGsD,EAAIC,KAAKK,kBAAkB,yBAAyBvE,EAAIa,QAAQ,CAACsB,IAAI,kBAAkB6B,GAAG,SAASC,GAAK,MAAO,CAAC9D,EAAG,MAAM,CAACA,EAAG,SAAS,CAACH,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYW,EAAIC,KAAKM,uBAAyBP,EAAIC,KAAKO,YAAY,UAAWR,EAAIC,KAAe,WAAE/D,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,OAAO,CAACE,YAAY,aAAa,CAACL,EAAI4B,GAAG,QAAQ5B,EAAIW,GAAGsD,EAAIC,KAAKQ,YAAY,SAAS1E,EAAIa,KAAMoD,EAAIC,KAAKM,uBAAyBP,EAAIC,KAAKO,UAAWtE,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,OAAO,CAACE,YAAY,cAAc,CAACL,EAAI4B,GAAG,OAAO5B,EAAIW,GAAGX,EAAIsD,YAAYW,EAAIC,KAAKO,YAAY,YAAYzE,EAAIa,UAAU,CAACsB,IAAI,kBAAkB6B,GAAG,SAASC,GAAK,MAAO,CAAC9D,EAAG,eAAe,CAACE,YAAY,mBAAmBsE,YAAY,CAAC,MAAQ,SAASrE,MAAM,CAAC,KAAO,SAAS,IAAM,EAAE,IAAM2D,EAAIC,KAAKI,mBAAqBL,EAAIC,KAAKE,SAAS,SAAWpE,EAAI6B,QAAQ,MAAQ7B,EAAI4E,kBAAkBX,EAAIC,OAAOnD,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOhB,EAAI6E,uBAAuBZ,EAAIC,OAAO,KAAO,SAASlD,GAAQ,OAAOhB,EAAI8E,qBAAqBb,EAAIC,OAAO,MAAQ,SAASlD,GAAQ,OAAIA,EAAOO,KAAKS,QAAQ,QAAQhC,EAAIiC,GAAGjB,EAAOkB,QAAQ,QAAQ,GAAGlB,EAAOmB,IAAI,SAAkB,KAAcnC,EAAI8E,qBAAqBb,EAAIC,QAAQ7B,MAAM,CAACC,MAAO2B,EAAIC,KAAmB,eAAE3B,SAAS,SAAUC,GAAMxC,EAAI+E,KAAKd,EAAIC,KAAM,iBAAkBlE,EAAIgF,GAAGxC,KAAOE,WAAW,6BAA8BuB,EAAIC,KAAKe,gBAAkBhB,EAAIC,KAAKI,mBAAqBL,EAAIC,KAAKE,UAAWjE,EAAG,0BAA0B,CAACG,MAAM,CAAC,OAAQ,IAAQ,CAACN,EAAI4B,GAAG,kBAAkB5B,EAAIW,QAAkCb,IAA/BmE,EAAIC,KAAKI,kBAAkCL,EAAIC,KAAKI,kBAAoBL,EAAIC,KAAKE,UAAU,OAAOpE,EAAIa,QAAQ,CAACsB,IAAI,qBAAqB6B,GAAG,SAASC,GAAK,MAAO,CAAC9D,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAIkF,gBAAgBjB,EAAIC,QAAQ,UAAWD,EAAIC,KAAKiB,WAAalB,EAAIC,KAAKe,eAAiB,EAAG9E,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,OAAO,CAACE,YAAY,aAAa,CAACL,EAAI4B,GAAG,QAAQ5B,EAAIW,GAAGX,EAAIsD,YAAaW,EAAIC,KAAKiB,UAAYlB,EAAIC,KAAKE,SAAYH,EAAIC,KAAKe,iBAAiB,YAAYjF,EAAIa,WAAW,MAAK,EAAM,eAAe,GAAGb,EAAIa,KAAMb,EAAI2C,YAAc3C,EAAI2C,WAAWgB,WAAa3D,EAAIoF,eAAgBjF,EAAG,SAAS,CAACE,YAAY,QAAQ,CAACF,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACL,EAAI4B,GAAG,iBAAiBzB,EAAG,eAAe,CAACA,EAAG,qBAAqB,CAACG,MAAM,CAAC,QAAUN,EAAIqF,mBAAmBtE,GAAG,CAAC,OAASf,EAAIsF,oBAAoBjD,MAAM,CAACC,MAAOtC,EAAc,WAAEuC,SAAS,SAAUC,GAAMxC,EAAIuF,WAAW/C,GAAKE,WAAW,iBAAiB,GAAuB,kBAAnB1C,EAAIuF,YAAmCvF,EAAI2C,WAAW6C,sBAAuJxF,EAAIa,KAApIV,EAAG,UAAU,CAACG,MAAM,CAAC,QAAU,UAAU,KAAO,KAAK,CAACN,EAAI4B,GAAG,oEAA6E,GAAG5B,EAAIa,KAAMb,EAAI2C,YAAc3C,EAAI2C,WAAWgB,WAAa3D,EAAIoF,eAAgBjF,EAAG,SAAS,CAACE,YAAY,4BAA4B,CAACF,EAAG,MAAM,CAACE,YAAY,kCAAkC,CAACF,EAAG,eAAe,CAACE,YAAY,oBAAoBC,MAAM,CAAC,KAAO,iBAAiB,KAAO,QAAQH,EAAG,KAAK,CAACE,YAAY,QAAQ,CAACL,EAAI4B,GAAG,qBAAqB,GAAGzB,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACG,MAAM,CAAC,KAAO,KAAK,GAAK,IAAI,YAAY,MAAM,CAACH,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG,oBAAoBzB,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAIyF,sBAAsB,YAAazF,EAAI0F,eAAiB,EAAGvF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACL,EAAI4B,GAAG,gBAAgBzB,EAAG,OAAO,CAACE,YAAY,2BAA2B,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAI0F,iBAAiB,YAAY1F,EAAIa,KAAKV,EAAG,MAAM,CAACE,YAAY,4BAA4B,CAACF,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACF,EAAG,SAAS,CAACH,EAAI4B,GAAG,kCAAkCzB,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACF,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACL,EAAI4B,GAAG5B,EAAIW,GAAGX,EAAIsD,YAAYtD,EAAI2F,oBAAoB,mBAAmB,IAAI,GAAG3F,EAAIa,KAAMb,EAAI2C,YAAc3C,EAAI2C,WAAWgB,WAAa3D,EAAIoF,eAAgBjF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,WAAW,CAACG,MAAM,CAAC,QAAU,UAAU,KAAO,KAAK,SAAWN,EAAI6B,UAAY7B,EAAI4F,kBAAkB7E,GAAG,CAAC,MAAQf,EAAI6F,gBAAgB,CAAE7F,EAAW,QAAEG,EAAG,YAAY,CAACE,YAAY,OAAOC,MAAM,CAAC,MAAQ,MAAMH,EAAG,eAAe,CAACE,YAAY,OAAOC,MAAM,CAAC,KAAO,kBAAkB,KAAO,QAAQN,EAAI4B,GAAG,qBAAqB,IAAI,GAAG5B,EAAIa,MAAM,IACt1SM,EAAkB,G,8KC4LP,GACf8B,KAAA,iBACA6C,KAAA,WACA,OACArD,aAAA,GACAE,WAAA,KACA4C,WAAA,iBACA1D,SAAA,EACAgC,WAAA,CACA,CAAA1B,IAAA,OAAA4D,MAAA,QACA,CAAA5D,IAAA,cAAA4D,MAAA,gBAAAC,QAAA,cAAAC,QAAA,eACA,CAAA9D,IAAA,eAAA4D,MAAA,gBAAAC,QAAA,cAAAC,QAAA,eACA,CAAA9D,IAAA,YAAA4D,MAAA,mBAAAC,QAAA,aAAAC,QAAA,cACA,CAAA9D,IAAA,YAAA4D,MAAA,aAAAC,QAAA,cAAAC,QAAA,eACA,CAAA9D,IAAA,eAAA4D,MAAA,sBAAAC,QAAA,aAAAC,QAAA,iBAIAC,SAAA,CACAb,kBAAA,WACA,IAAAc,EAAA,GAKA,OAJA,KAAAxD,YAAA,KAAAA,WAAA6C,uBACAW,EAAAC,KAAA,CAAA9D,MAAA,gBAAAxB,KAAA,gCAEAqF,EAAAC,KAAA,CAAA9D,MAAA,iBAAAxB,KAAA,mBACAqF,GAEAf,eAAA,WACA,SAAAzC,aAAA,KAAAA,WAAAiB,WAAA,SACA,IAAAyC,EAAA,KAAA1D,WAAAiB,WAAA0C,MAAA,SAAAC,GACA,IAAAC,EAAAC,WAAAF,EAAAtB,gBACA,GAAAyB,MAAAF,IAAA,OAAAA,QAAA1G,IAAA0G,EACA,SAEA,IAAAG,EAAAC,KAAAC,MAAAL,GACA,OAAAG,EAAA,GAAAA,GAAAJ,EAAAnC,YAEA,OAAAiC,GAEAV,kBAAA,WACA,YAAAhD,YAAA,KAAAA,WAAAiB,WACA,KAAAjB,WAAAiB,WAAAnE,QAAA,SAAAqH,EAAAP,GACA,IAAAQ,EAAAN,WAAAF,EAAAtB,iBAAA,EAEA+B,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SACA2C,EAAAC,IACAD,EAAAC,GAEAD,EAAA,IACAA,EAAA,GAEAA,EAAAH,KAAAC,MAAAE,GAEA,IAAAE,EAAAV,EAAA/B,uBAAA+B,EAAA9B,UACA,OAAAqC,EAAAC,EAAAE,IACA,GAfA,GAiBAxB,oBAAA,WACA,YAAA9C,YAAA,KAAAA,WAAAiB,WACA,KAAAjB,WAAAiB,WAAAnE,QAAA,SAAAqH,EAAAP,GACA,IAAAQ,EAAAN,WAAAF,EAAAtB,iBAAA,EACA+B,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SACA2C,EAAAC,IACAD,EAAAC,GAEAD,EAAA,IACAA,EAAA,GAEAA,EAAAH,KAAAC,MAAAE,GAEA,IAAAG,EAAAX,EAAA9B,WAAA,EACA,OAAAqC,EAAAC,EAAAG,IACA,GAdA,GAgBAxB,eAAA,WACA,YAAAC,kBAAA,KAAAF,qBAEAG,iBAAA,WACA,aAAAR,kBACA,uBAAAG,aAAA,KAAA5C,WAAA6C,yBAIA2B,QAAA,eAAAC,EAAA,KACA,KAAAC,WAAA,WACAD,EAAAE,MAAAC,aACAH,EAAAE,MAAAC,YAAAC,YAIAC,QAAA,CACArF,WAAA,eAAAsF,EAAA,YAAAC,eAAAC,iBAAAC,MAAA,SAAAC,IAAA,IAAAC,EAAAC,EAAA,OAAAJ,iBAAAK,MAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,UACAV,EAAAjF,aAAA4F,OAAA,CAAAH,EAAAE,KAAA,QASA,OARAV,EAAAY,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,QACAJ,KAAA,QACAM,KAAA,+BACAP,QAAA,YAEA2H,EAAAM,OAAA,iBAIA,OAAAd,EAAA7F,SAAA,EAAAqG,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAEAV,EAAAe,MAAAC,IAAA,iCACAC,OAAA,CAAAlG,aAAAiF,EAAAjF,aAAA4F,UACA,OAFAN,EAAAG,EAAAU,KAIA,MAAAb,EAAAc,SACAnB,EAAA/E,WAAAoF,EAAAjC,KAIA4B,EAAA/E,WAAAiB,YACA8D,EAAA/E,WAAAiB,WAAAkF,SAAA,SAAAvC,GACAmB,EAAA3C,KAAAwB,EAAA,yBAEAzG,IAAAyG,EAAAjC,mBAEAoD,EAAA3C,KAAAwB,EAAA,oBAAAA,EAAAnC,aAMAsD,EAAA/E,WAAA6C,wBACAkC,EAAAnC,WAAA,mBAEA2C,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAa,GAAAb,EAAA,YAEAc,QAAAC,MAAA,wBAAAf,EAAAa,IACAf,EAAA,yDACAE,EAAAa,GAAAhB,UAAAG,EAAAa,GAAAhB,SAAAjC,OACAkC,EAAAE,EAAAa,GAAAhB,SAAAjC,KAAAoD,SAAAhB,EAAAa,GAAAhB,SAAAjC,MAAAkC,GAEAN,EAAAY,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,QACAJ,KAAA,QACAM,KAAAkH,EACAzH,QAAA,YAGAmH,EAAA/E,WAAA,aAEA,OAFAuF,EAAAC,KAAA,GAEAT,EAAA7F,SAAA,EAAAqG,EAAAiB,OAAA,6BAAAjB,EAAAkB,UAAAtB,EAAA,wBA1DAH,IA6DA9C,uBAAA,SAAA0B,GAAA,IAAA8C,EAAA,KAEA7C,EAAAC,WAAAF,EAAAtB,iBAGAyB,MAAAF,IAAA,OAAAA,QAAA1G,IAAA0G,KACAA,EAAA,GAIA,IAAAQ,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SAGAoC,EAAAQ,IACAR,EAAAQ,EAEA,KAAAK,WAAA,WACAgC,EAAAf,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,aACAJ,KAAA,kBACAM,KAAA,qDAAAwI,OAAAtC,EAAA,KACAzG,QAAA,iBAOAiG,EAAA,IACAA,EAAA,GAIAA,EAAAI,KAAAC,MAAAL,GAGA,KAAAzB,KAAAwB,EAAA,iBAAAC,IAEA1B,qBAAA,SAAAyB,GAEA,IAAAC,EAAAC,WAAAF,EAAAtB,iBAEAyB,MAAAF,IAAA,OAAAA,QAAA1G,IAAA0G,KACAA,EAAA,GAIA,IAAAQ,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SAGAoC,EAAAQ,IACAR,EAAAQ,GAGAR,EAAA,IACAA,EAAA,GAGAA,EAAAI,KAAAC,MAAAL,GACA,KAAAzB,KAAAwB,EAAA,iBAAAC,IAEA5B,kBAAA,SAAA2B,GACA,UAAAA,EAAAtB,qBAAAnF,IAAAyG,EAAAtB,eACA,YAEA,IAAAuB,EAAAC,WAAAF,EAAAtB,gBACA,GAAAyB,MAAAF,GACA,SAGA,IAAAQ,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SACA,QAAAoC,EAAA,GAAAA,EAAAQ,IAGA,MAEA9B,gBAAA,SAAAqB,GACA,IAAAQ,EAAAN,WAAAF,EAAAtB,iBAAA,EAEA+B,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SAEA2C,EAAAC,IACAD,EAAAC,GAEAD,EAAA,IACAA,EAAA,GAEAA,EAAAH,KAAAC,MAAAE,GAEA,IAAAE,EAAAV,EAAA/B,uBAAA+B,EAAA9B,UACA,OAAAsC,EAAAE,GAEA5C,qBAAA,SAAAkC,GACA,IAAAgD,OAAAzJ,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,SACA,WAAAmF,EACA,cACAA,EAAAhD,EAAAnC,SACA,eAEA,gBAEAkB,mBAAA,aAGAO,cAAA,eAAA2D,EAAA,YAAA7B,eAAAC,iBAAAC,MAAA,SAAA4B,IAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAtD,EAAAQ,EAAAC,EAAA8C,EAAA/B,EAAAC,EAAA,OAAAJ,iBAAAK,MAAA,SAAA8B,GAAA,eAAAA,EAAA5B,KAAA4B,EAAA3B,MAAA,UACAoB,EAAA5D,iBAAA,CAAAmE,EAAA3B,KAAA,eAAA2B,EAAAvB,OAAA,iBAGAkB,EAAA,GACAC,EAAA,GAAAC,EAAAI,eAEAR,EAAA7G,WAAAiB,YAAAmG,EAAA5B,KAAA,EAAAyB,EAAAK,IAAA,WAAAJ,EAAAD,EAAAM,KAAAC,KAAA,CAAAJ,EAAA3B,KAAA,SAGA,GAHA7B,EAAAsD,EAAAvH,MACAyE,EAAAN,WAAAF,EAAAtB,iBAAA,GAGAyB,MAAAK,GAAA,CAAAgD,EAAA3B,KAAA,SACA,OAAAsB,EAAAtD,KAAA,+BAAAkD,OAAA/C,EAAArC,KAAAjB,OAAA8G,EAAAvB,OAAA,uBAOA,GAFAzB,EAAAH,KAAAC,MAAAE,KAGAA,EAAA,IAAAgD,EAAA3B,KAAA,SACA,OAAAsB,EAAAtD,KAAA,uBAAAkD,OAAA/C,EAAArC,KAAAjB,KAAA,wBAAA8G,EAAAvB,OAAA,uBAKA,GAAAxB,OAAAlH,IAAAyG,EAAAjC,kBAAAiC,EAAAjC,kBAAAiC,EAAAnC,WAEA2C,EAAAC,GAAA,CAAA+C,EAAA3B,KAAA,SACA,OAAAsB,EAAAtD,KAAA,uBAAAkD,OAAA/C,EAAArC,KAAAjB,KAAA,MAAAqG,OAAAvC,EAAA,wCAAAuC,OAAAtC,EAAA,MAAA+C,EAAAvB,OAAA,uBAKAzB,EAAA,GACA4C,EAAAvD,KAAA,CACAgE,YAAA7D,EAAA8D,GACAjG,SAAA2C,IAEA,QAAAgD,EAAA3B,KAAA,gBAAA2B,EAAA3B,KAAA,iBAAA2B,EAAA5B,KAAA,GAAA4B,EAAAhB,GAAAgB,EAAA,YAAAH,EAAAU,EAAAP,EAAAhB,IAAA,eAAAgB,EAAA5B,KAAA,GAAAyB,EAAAW,IAAAR,EAAAZ,OAAA,iBAIAO,EAAA7J,OAAA,IAAAkK,EAAA3B,KAAA,SASA,OARAoB,EAAAlB,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,mBACAJ,KAAA,QACAM,KAAA4I,EAAAc,KAAA,MACAjK,QAAA,YAEAwJ,EAAAvB,OAAA,qBAIA,IAAAmB,EAAA9J,OAAA,CAAAkK,EAAA3B,KAAA,SASA,OARAoB,EAAAlB,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,QACAJ,KAAA,QACAM,KAAA,4CACAP,QAAA,YAEAwJ,EAAAvB,OAAA,kBAWA,OAPAgB,EAAA3H,SAAA,EAAAkI,EAAA5B,KAAA,GAEA2B,EAAA,CACArH,aAAA+G,EAAA/G,aAAA4F,OACA9C,WAAAiE,EAAAjE,WACAoE,cACAc,MAAA,IACAV,EAAA3B,KAAA,GAEAoB,EAAAf,MAAAiC,KAAA,gCAAAZ,GAAA,QAAA/B,EAAAgC,EAAAnB,KAEA,MAAAb,EAAAc,SACAW,EAAAlB,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,UACAJ,KAAA,kBACAM,KAAA,UAAAwI,OAAAvB,EAAAjC,KAAA6E,aAAA,4BACApK,QAAA,aAMA,mBAAAiJ,EAAAjE,YAAAwC,EAAAjC,KAAA8E,gBACApB,EAAAlB,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,yBACAJ,KAAA,eACAM,KAAA,mBAAAwI,OAAAvB,EAAAjC,KAAA8E,cAAAC,cAAA,cAAAvB,OAAAE,EAAAlG,YAAAyE,EAAAjC,KAAA8E,cAAAE,eAAA,QACAvK,QAAA,UAKAiJ,EAAAuB,oBAAAhD,EAAAjC,OAIAkF,YAAA,WACAxB,EAAA/G,aAAA,GACA+G,EAAA7G,WAAA,KACA6G,EAAAjE,WAAA,iBACAiE,EAAAlC,MAAAC,aACAiC,EAAAlC,MAAAC,YAAAC,UAEA,MACAuC,EAAA3B,KAAA,iBAAA2B,EAAA5B,KAAA,GAAA4B,EAAAkB,GAAAlB,EAAA,aAEAf,QAAAC,MAAA,2BAAAc,EAAAkB,IACAjD,EAAA,8CACA+B,EAAAkB,GAAAlD,UAAAgC,EAAAkB,GAAAlD,SAAAjC,OACAkC,EAAA+B,EAAAkB,GAAAlD,SAAAjC,KAAAoD,SAAAa,EAAAkB,GAAAlD,SAAAjC,MAAAkC,GAEAwB,EAAAlB,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,QACAJ,KAAA,QACAM,KAAAkH,EACAzH,QAAA,YAEA,QAEA,OAFAwJ,EAAA5B,KAAA,GAEAqB,EAAA3H,SAAA,EAAAkI,EAAAZ,OAAA,6BAAAY,EAAAX,UAAAK,EAAA,sCAtIA9B,IAyIA7E,WAAA,SAAAoI,GACA,IAAAA,EAAA,UACA,IAAAC,EAAA,IAAAC,KAAAF,GACA,OAAAC,EAAAE,kBAEA/H,YAAA,SAAAgI,GACA,OAAAA,EACA7E,WAAA6E,GAAAC,QAAA,GADA,QAGAzJ,OAAA,WACA,KAAA0J,QAAApF,KAAA,CAAAnD,KAAA,wBAEA8H,oBAAA,SAAAU,GAAA,IAAAC,EAAA,YAAA/D,eAAAC,iBAAAC,MAAA,SAAA8D,IAAA,IAAAC,EAAAC,EAAAlC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAxE,iBAAAK,MAAA,SAAAoE,GAAA,eAAAA,EAAAlE,KAAAkE,EAAAjE,MAAA,UACAqD,KAAAb,cAAA,CAAAyB,EAAAjE,KAAA,QACA,OAAAY,QAAAC,MAAA,4BAAAoD,EAAA7D,OAAA,iBAwEA,GAlEAmB,EAAA8B,EAAA9B,aAAA,GAEAmC,EAAA,CACAjJ,YAAA4I,EAAAb,cAAAC,cACA9H,UAAA0I,EAAAb,cAAA0B,YACA5I,YAAA+H,EAAAb,cAAAE,cACAvH,SAAAkI,EAAAb,cAAAE,cACAtH,UAAA,EACAC,eAAA,EACA8I,WAAAd,EAAAb,cAAAE,cACA0B,aAAA,EACA/B,MAAA,qCAAAnB,QAAA,QAAAsC,EAAAH,EAAAgB,2BAAA,IAAAb,OAAA,EAAAA,EAAA/I,cAAA,OACAM,cAAA,CACAC,SAAA,SACAC,SAAA,UAEAqJ,eAAA,KACA1J,SAAAyI,EAAAb,cAAA+B,aAAA,CACA1J,KAAAwI,EAAAb,cAAA+B,cACA,KACA/I,WAAA+F,EAAAiD,KAAA,SAAArG,GAAA,IAAAsG,EAAAC,EAAA,OACA5I,KAAA,CACAjB,MAAA,QAAA4J,EAAAtG,EAAArC,YAAA,IAAA2I,OAAA,EAAAA,EAAA5J,OAAA,cACAkB,UAAA,QAAA2I,EAAAvG,EAAArC,YAAA,IAAA4I,OAAA,EAAAA,EAAA3I,WAAA,OAEAC,SAAAmC,EAAAnC,UAAA,EACA2I,WAAAxG,EAAA9B,WAAA,IAAA8B,EAAAnC,UAAA,GACAK,UAAA8B,EAAA9B,WAAA,MAEAuI,eAAA,EACAC,cAAA,CACAhK,KAAA,kBAEAS,YAAA+H,EAAAb,cAAAE,cACAoC,iBAAAzB,EAAAb,cAAAC,iBAKAiB,EAAAqB,WAAA,EACArB,EAAAsB,YAAA,CACAvC,cAAAY,EAAAb,cAAAC,cACAwC,WAAA5B,EAAAb,cAAAyC,WACAC,gBAAA,QAAAzB,EAAAJ,EAAAgB,2BAAA,IAAAZ,OAAA,EAAAA,EAAAhJ,cAAA,MACA8H,aAAAc,EAAAd,cAGA3B,QAAAuE,IAAA,sCAAAzB,GAGAC,EAAAL,EAAA8B,MAAAC,aAAA/B,EAAAgC,SAAAC,MACA3B,EAAAD,EAAA6B,OAAAC,QAGA5B,EAAA,IAAAD,EAAA,CACA8B,OAAApC,EACAqC,UAAA,CACAC,SAAAlC,EACAqB,WAAA,KAKAlB,EAAAgC,SAGA/B,EAAAgC,OAAAC,KAAA,aACAjC,EAAA,CAAAG,EAAAjE,KAAA,SASA,OARAsD,EAAApD,OAAA,CACA3G,UAAA4G,aACAjH,MAAA,CACAV,MAAA,cACAJ,KAAA,QACAM,KAAA,wCACAP,QAAA,aAEA8L,EAAA7D,OAAA,yBAAA6D,EAAAjE,KAAA,GAKAsD,EAAArE,YAAA,eAAAgF,EAAAjE,KAAA,GACA,IAAAgG,SAAA,SAAAC,GAAA,OAAArD,WAAAqD,EAAA,gBAIA,GADAlC,EAAAV,EAAAb,cAAAC,eAAA,KACAsB,GAAAF,EAAAqC,IACA,IACAlC,EAAAH,EAAAqC,IAAAC,cAAA,gBACAnC,GACAoC,IAAApC,EAAAD,EAAA,CACAsC,OAAA,UACAC,MAAA,IACAC,OAAA,GACAC,cAAA,EACAC,OAAA,EACAC,WAAA,UACAC,UAAA,YAGA,MAAA9F,GACAD,QAAAC,MAAA,4BAAAA,GAKAiD,EAAA8C,SAAAC,MAAA,gGAAA3F,OAIAmC,EAAAb,cAAAC,cAAA,ihFAAAvB,OAqDA2C,EAAAqC,IAAAY,UAAA,+CAKAhD,EAAA8C,SAAAG,QAGAnE,YAAA,WACAkB,EAAA1E,QACA0E,EAAAkD,QAGApE,YAAA,WACAkB,EAAAiD,QACAlD,KAAAqC,KACArC,EAAAoD,aAEA,OACA,8BAAAhD,EAAAjD,UAAAuC,MA9LAhE,MCplBsW,I,wBCQlWhG,EAAY,eACd,EACA5B,EACAoB,GACA,EACA,KACA,WACA,MAIa,aAAAQ,E,yJClBf,SAASqI,EAA2BsF,EAAGhF,GACrC,IAAIiF,EAAI,oBAAsBC,QAAUF,EAAEE,OAAOC,WAAaH,EAAE,cAChE,IAAKC,EAAG,CACN,GAAIG,MAAMC,QAAQL,KAAOC,EAAIK,eAA2BN,KAAOhF,GAAKgF,GAAK,iBAAmBA,EAAEzP,OAAQ,CACpG0P,IAAMD,EAAIC,GACV,IAAIvK,EAAK,EACP6K,EAAI,aACN,MAAO,CACL5F,EAAG4F,EACH3F,EAAG,WACD,OAAOlF,GAAMsK,EAAEzP,OAAS,CACtBsK,MAAM,GACJ,CACFA,MAAM,EACN7H,MAAOgN,EAAEtK,OAGbsF,EAAG,SAAWgF,GACZ,MAAMA,GAER/E,EAAGsF,GAGP,MAAM,IAAIC,UAAU,yIAEtB,IAAIC,EACFC,GAAI,EACJC,GAAI,EACN,MAAO,CACLhG,EAAG,WACDsF,EAAIA,EAAEW,KAAKZ,IAEbpF,EAAG,WACD,IAAIoF,EAAIC,EAAEnH,OACV,OAAO4H,EAAIV,EAAEnF,KAAMmF,GAErBhF,EAAG,SAAWgF,GACZW,GAAI,EAAIF,EAAIT,GAEd/E,EAAG,WACD,IACEyF,GAAK,MAAQT,EAAE,WAAaA,EAAE,YAC9B,QACA,GAAIU,EAAG,MAAMF,O,qBC5CrB,IAAII,EAAY,EAAQ,QACpBC,EAAW,EAAQ,QACnBC,EAAgB,EAAQ,QACxBC,EAAW,EAAQ,QAGnBC,EAAe,SAAUC,GAC3B,OAAO,SAAUC,EAAM/Q,EAAYgR,EAAiBC,GAClDR,EAAUzQ,GACV,IAAIkR,EAAIR,EAASK,GACbI,EAAOR,EAAcO,GACrB/Q,EAASyQ,EAASM,EAAE/Q,QACpBiR,EAAQN,EAAW3Q,EAAS,EAAI,EAChCkR,EAAIP,GAAY,EAAI,EACxB,GAAIE,EAAkB,EAAG,MAAO,EAAM,CACpC,GAAII,KAASD,EAAM,CACjBF,EAAOE,EAAKC,GACZA,GAASC,EACT,MAGF,GADAD,GAASC,EACLP,EAAWM,EAAQ,EAAIjR,GAAUiR,EACnC,MAAMhB,UAAU,+CAGpB,KAAMU,EAAWM,GAAS,EAAIjR,EAASiR,EAAOA,GAASC,EAAOD,KAASD,IACrEF,EAAOjR,EAAWiR,EAAME,EAAKC,GAAQA,EAAOF,IAE9C,OAAOD,IAIXK,EAAOC,QAAU,CAGfpS,KAAM0R,GAAa,GAGnBW,MAAOX,GAAa,K,kCCtCtB","file":"js/chunk-71903056.3380fd62.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $reduce = require('../internals/array-reduce').left;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\nvar CHROME_VERSION = require('../internals/engine-v8-version');\nvar IS_NODE = require('../internals/engine-is-node');\n\nvar STRICT_METHOD = arrayMethodIsStrict('reduce');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('reduce', { 1: 0 });\n// Chrome 80-82 has a critical bug\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1049982\nvar CHROME_BUG = !IS_NODE && CHROME_VERSION > 79 && CHROME_VERSION < 83;\n\n// `Array.prototype.reduce` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH || CHROME_BUG }, {\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"toastification\"},[_c('div',{staticClass:\"d-flex align-items-start\"},[_c('b-avatar',{staticClass:\"mr-75 flex-shrink-0\",attrs:{\"variant\":_vm.variant,\"size\":\"1.8rem\"}},[_c('feather-icon',{attrs:{\"icon\":_vm.icon,\"size\":\"15\"}})],1),_c('div',{staticClass:\"d-flex flex-grow-1\"},[_c('div',[(_vm.title)?_c('h5',{staticClass:\"mb-0 font-weight-bolder toastification-title\",class:(\"text-\" + _vm.variant),domProps:{\"textContent\":_vm._s(_vm.title)}}):_vm._e(),(_vm.text)?_c('small',{staticClass:\"d-inline-block text-body\",domProps:{\"textContent\":_vm._s(_vm.text)}}):_vm._e()]),_c('span',{staticClass:\"cursor-pointer toastification-close-icon ml-auto \",on:{\"click\":function($event){return _vm.$emit('close-toast')}}},[(!_vm.hideClose)?_c('feather-icon',{staticClass:\"text-body\",attrs:{\"icon\":\"XIcon\"}}):_vm._e()],1)])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"toastification\">\r\n    <div class=\"d-flex align-items-start\">\r\n      <b-avatar\r\n        :variant=\"variant\"\r\n        size=\"1.8rem\"\r\n        class=\"mr-75 flex-shrink-0\"\r\n      >\r\n        <feather-icon\r\n          :icon=\"icon\"\r\n          size=\"15\"\r\n        />\r\n      </b-avatar>\r\n      <div class=\"d-flex flex-grow-1\">\r\n        <div>\r\n          <h5\r\n            v-if=\"title\"\r\n            class=\"mb-0 font-weight-bolder toastification-title\"\r\n            :class=\"`text-${variant}`\"\r\n            v-text=\"title\"\r\n          />\r\n          <small\r\n            v-if=\"text\"\r\n            class=\"d-inline-block text-body\"\r\n            v-text=\"text\"\r\n          />\r\n        </div>\r\n        <span\r\n          class=\"cursor-pointer toastification-close-icon ml-auto \"\r\n          @click=\"$emit('close-toast')\"\r\n        >\r\n          <feather-icon\r\n            v-if=\"!hideClose\"\r\n            icon=\"XIcon\"\r\n            class=\"text-body\"\r\n          />\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { BAvatar } from 'bootstrap-vue'\r\n\r\nexport default {\r\n  components: {\r\n    BAvatar,\r\n  },\r\n  props: {\r\n    variant: {\r\n      type: String,\r\n      default: 'primary',\r\n    },\r\n    icon: {\r\n      type: String,\r\n      default: null,\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: null,\r\n    },\r\n    text: {\r\n      type: String,\r\n      default: null,\r\n    },\r\n    hideClose: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.toastification-close-icon,\r\n.toastification-title {\r\n  line-height: 26px;\r\n}\r\n\r\n.toastification-title {\r\n  color: inherit;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToastificationContent.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToastificationContent.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ToastificationContent.vue?vue&type=template&id=55dd3057&scoped=true\"\nimport script from \"./ToastificationContent.vue?vue&type=script&lang=js\"\nexport * from \"./ToastificationContent.vue?vue&type=script&lang=js\"\nimport style0 from \"./ToastificationContent.vue?vue&type=style&index=0&id=55dd3057&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"55dd3057\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ToastificationContent.vue?vue&type=style&index=0&id=55dd3057&prod&lang=scss&scoped=true\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"return-products-container\"},[_c('div',{staticClass:\"page-header\"},[_c('h2',{staticClass:\"mb-0\"},[_vm._v(\"Return Products\")]),_c('b-button',{attrs:{\"variant\":\"outline-secondary\",\"disabled\":_vm.loading},on:{\"click\":_vm.goBack}},[_vm._v(\" Back to POS \")])],1),_c('b-card',{staticClass:\"mb-4\"},[_c('h5',{staticClass:\"mb-3\"},[_vm._v(\"Enter Ticket Number\")]),_c('b-row',[_c('b-col',{attrs:{\"cols\":\"12\",\"md\":\"6\"}},[_c('b-input-group',[_c('b-form-input',{ref:\"ticketInput\",attrs:{\"placeholder\":\"Enter ticket number...\",\"disabled\":_vm.loading},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.loadTicket($event)}},model:{value:(_vm.ticketNumber),callback:function ($$v) {_vm.ticketNumber=$$v},expression:\"ticketNumber\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"primary\",\"disabled\":_vm.loading || !_vm.ticketNumber},on:{\"click\":_vm.loadTicket}},[(_vm.loading)?_c('b-spinner',{staticClass:\"mr-1\",attrs:{\"small\":\"\"}}):_c('feather-icon',{attrs:{\"icon\":\"SearchIcon\"}}),_vm._v(\" Load Ticket \")],1)],1)],1)],1)],1)],1),(_vm.ticketData)?_c('b-card',{staticClass:\"mb-4 ticket-details-card\"},[_c('div',{staticClass:\"d-flex align-items-center mb-3\"},[_c('feather-icon',{staticClass:\"mr-2 text-primary\",attrs:{\"icon\":\"FileTextIcon\",\"size\":\"20\"}}),_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"Ticket Details\")])],1),_c('b-row',[_c('b-col',{attrs:{\"cols\":\"12\",\"md\":\"6\"}},[_c('div',{staticClass:\"detail-item\"},[_c('strong',{staticClass:\"detail-label\"},[_vm._v(\"Ticket Number:\")]),_c('span',{staticClass:\"detail-value\"},[_vm._v(_vm._s(_vm.ticketData.ticket.salesNumber))])]),_c('div',{staticClass:\"detail-item\"},[_c('strong',{staticClass:\"detail-label\"},[_vm._v(\"Date:\")]),_c('span',{staticClass:\"detail-value\"},[_vm._v(_vm._s(_vm.formatDate(_vm.ticketData.ticket.salesDate)))])]),(_vm.ticketData.ticket.customer)?_c('div',{staticClass:\"detail-item\"},[_c('strong',{staticClass:\"detail-label\"},[_vm._v(\"Customer:\")]),_c('span',{staticClass:\"detail-value\"},[_vm._v(_vm._s(_vm.ticketData.ticket.customer.name))]),_c('small',{staticClass:\"text-muted ml-2\"},[_vm._v(\"(\"+_vm._s(_vm.ticketData.ticket.customer.customerCode)+\")\")])]):_vm._e(),(_vm.ticketData.ticket.createdByUser)?_c('div',{staticClass:\"detail-item\"},[_c('strong',{staticClass:\"detail-label\"},[_vm._v(\"Cashier:\")]),_c('span',{staticClass:\"detail-value\"},[_vm._v(_vm._s(_vm.ticketData.ticket.createdByUser.fullName || _vm.ticketData.ticket.createdByUser.username))])]):_vm._e()]),_c('b-col',{attrs:{\"cols\":\"12\",\"md\":\"6\"}},[_c('div',{staticClass:\"ticket-summary\"},[(_vm.ticketData.ticket.subtotal)?_c('div',{staticClass:\"summary-item\"},[_c('span',{staticClass:\"summary-label\"},[_vm._v(\"Subtotal:\")]),_c('span',{staticClass:\"summary-value\"},[_vm._v(_vm._s(_vm.formatPrice(_vm.ticketData.ticket.subtotal))+\" TND\")])]):_vm._e(),(_vm.ticketData.ticket.taxAmount)?_c('div',{staticClass:\"summary-item\"},[_c('span',{staticClass:\"summary-label\"},[_vm._v(\"Tax (VAT):\")]),_c('span',{staticClass:\"summary-value\"},[_vm._v(_vm._s(_vm.formatPrice(_vm.ticketData.ticket.taxAmount))+\" TND\")])]):_vm._e(),(_vm.ticketData.ticket.discountAmount)?_c('div',{staticClass:\"summary-item\"},[_c('span',{staticClass:\"summary-label\"},[_vm._v(\"Discount:\")]),_c('span',{staticClass:\"summary-value text-danger\"},[_vm._v(\"-\"+_vm._s(_vm.formatPrice(_vm.ticketData.ticket.discountAmount))+\" TND\")])]):_vm._e(),_c('div',{staticClass:\"summary-item total-amount\"},[_c('span',{staticClass:\"summary-label\"},[_c('strong',[_vm._v(\"Total Amount (TTC):\")])]),_c('span',{staticClass:\"summary-value\"},[_c('strong',[_vm._v(_vm._s(_vm.formatPrice(_vm.ticketData.ticket.totalAmount))+\" TND\")])])])]),(!_vm.ticketData.canReturn)?_c('div',{staticClass:\"detail-item mt-2\"},[_c('b-badge',{attrs:{\"variant\":\"danger\"}},[_vm._v(\"This ticket is too old to be returned\")])],1):_vm._e()])],1)],1):_vm._e(),(_vm.ticketData && _vm.ticketData.canReturn)?_c('b-card',{staticClass:\"mb-4 return-items-card\"},[_c('div',{staticClass:\"d-flex align-items-center mb-3\"},[_c('feather-icon',{staticClass:\"mr-2 text-primary\",attrs:{\"icon\":\"PackageIcon\",\"size\":\"20\"}}),_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"Select Items to Return\")])],1),_c('b-table',{staticClass:\"return-items-table\",attrs:{\"items\":_vm.ticketData.salesLines,\"fields\":_vm.lineFields,\"striped\":\"\",\"hover\":\"\",\"responsive\":\"\"},scopedSlots:_vm._u([{key:\"cell(item)\",fn:function(row){return [_c('div',[_c('strong',[_vm._v(_vm._s(row.item.item.name))]),_c('div',{staticClass:\"small text-muted\"},[_vm._v(_vm._s(row.item.item.itemCode))])])]}},{key:\"cell(originalQty)\",fn:function(row){return [_c('span',{staticClass:\"badge badge-secondary\"},[_vm._v(_vm._s(row.item.quantity))])]}},{key:\"cell(remainingQty)\",fn:function(row){return [_c('span',{staticClass:\"font-weight-bold\",class:_vm.getRemainingQtyClass(row.item)},[_vm._v(\" \"+_vm._s(row.item.remainingQuantity !== undefined ? row.item.remainingQuantity : row.item.quantity)+\" \")]),(row.item.returnedQuantity > 0)?_c('div',{staticClass:\"small text-muted\"},[_vm._v(\" (\"+_vm._s(row.item.returnedQuantity)+\" already returned) \")]):_vm._e()]}},{key:\"cell(unitPrice)\",fn:function(row){return [_c('div',[_c('strong',[_vm._v(_vm._s(_vm.formatPrice(row.item.unitPriceIncludingVat || row.item.unitPrice))+\" TND\")]),(row.item.vatPercent)?_c('div',{staticClass:\"small text-muted\"},[_c('span',{staticClass:\"text-info\"},[_vm._v(\"VAT: \"+_vm._s(row.item.vatPercent)+\"%\")])]):_vm._e(),(row.item.unitPriceIncludingVat && row.item.unitPrice)?_c('div',{staticClass:\"small text-muted\"},[_c('span',{staticClass:\"text-muted\"},[_vm._v(\"HT: \"+_vm._s(_vm.formatPrice(row.item.unitPrice))+\" TND\")])]):_vm._e()])]}},{key:\"cell(returnQty)\",fn:function(row){return [_c('b-form-input',{staticClass:\"return-qty-input\",staticStyle:{\"width\":\"100px\"},attrs:{\"type\":\"number\",\"min\":0,\"max\":row.item.remainingQuantity || row.item.quantity,\"disabled\":_vm.loading,\"state\":_vm.getReturnQtyState(row.item)},on:{\"input\":function($event){return _vm.onReturnQuantityChange(row.item)},\"blur\":function($event){return _vm.onReturnQuantityBlur(row.item)},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onReturnQuantityBlur(row.item)}},model:{value:(row.item.returnQuantity),callback:function ($$v) {_vm.$set(row.item, \"returnQuantity\", _vm._n($$v))},expression:\"row.item.returnQuantity\"}}),(row.item.returnQuantity > (row.item.remainingQuantity || row.item.quantity))?_c('b-form-invalid-feedback',{attrs:{\"state\":false}},[_vm._v(\" Cannot exceed \"+_vm._s(row.item.remainingQuantity !== undefined ? row.item.remainingQuantity : row.item.quantity)+\" \")]):_vm._e()]}},{key:\"cell(returnAmount)\",fn:function(row){return [_c('div',[_c('strong',{staticClass:\"text-success\"},[_vm._v(_vm._s(_vm.formatPrice(_vm.getReturnAmount(row.item)))+\" TND\")]),(row.item.vatAmount && row.item.returnQuantity > 0)?_c('div',{staticClass:\"small text-muted\"},[_c('span',{staticClass:\"text-info\"},[_vm._v(\"VAT: \"+_vm._s(_vm.formatPrice((row.item.vatAmount / row.item.quantity) * row.item.returnQuantity))+\" TND\")])]):_vm._e()])]}}],null,false,3139184715)})],1):_vm._e(),(_vm.ticketData && _vm.ticketData.canReturn && _vm.hasReturnItems)?_c('b-card',{staticClass:\"mb-4\"},[_c('h5',{staticClass:\"mb-3\"},[_vm._v(\"Return Type\")]),_c('b-form-group',[_c('b-form-radio-group',{attrs:{\"options\":_vm.returnTypeOptions},on:{\"change\":_vm.onReturnTypeChange},model:{value:(_vm.returnType),callback:function ($$v) {_vm.returnType=$$v},expression:\"returnType\"}})],1),(_vm.returnType === 'SIMPLE_RETURN' && !_vm.ticketData.isSimpleReturnEnabled)?_c('b-alert',{attrs:{\"variant\":\"warning\",\"show\":\"\"}},[_vm._v(\" Simple return is not enabled. Please select Return Voucher. \")]):_vm._e()],1):_vm._e(),(_vm.ticketData && _vm.ticketData.canReturn && _vm.hasReturnItems)?_c('b-card',{staticClass:\"mb-4 return-summary-card\"},[_c('div',{staticClass:\"d-flex align-items-center mb-3\"},[_c('feather-icon',{staticClass:\"mr-2 text-primary\",attrs:{\"icon\":\"CalculatorIcon\",\"size\":\"20\"}}),_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"Return Summary\")])],1),_c('b-row',[_c('b-col',{attrs:{\"cols\":\"12\",\"md\":\"6\",\"offset-md\":\"6\"}},[_c('div',{staticClass:\"return-summary\"},[_c('div',{staticClass:\"summary-row\"},[_c('span',{staticClass:\"summary-label\"},[_vm._v(\"Subtotal (HT):\")]),_c('span',{staticClass:\"summary-value\"},[_vm._v(_vm._s(_vm.formatPrice(_vm.totalReturnAmountHT))+\" TND\")])]),(_vm.totalReturnVAT > 0)?_c('div',{staticClass:\"summary-row\"},[_c('span',{staticClass:\"summary-label\"},[_vm._v(\"Tax (VAT):\")]),_c('span',{staticClass:\"summary-value text-info\"},[_vm._v(_vm._s(_vm.formatPrice(_vm.totalReturnVAT))+\" TND\")])]):_vm._e(),_c('div',{staticClass:\"summary-row total-return\"},[_c('span',{staticClass:\"summary-label\"},[_c('strong',[_vm._v(\"Total Return Amount (TTC):\")])]),_c('span',{staticClass:\"summary-value\"},[_c('strong',{staticClass:\"text-success\"},[_vm._v(_vm._s(_vm.formatPrice(_vm.totalReturnAmount))+\" TND\")])])])])])],1)],1):_vm._e(),(_vm.ticketData && _vm.ticketData.canReturn && _vm.hasReturnItems)?_c('div',{staticClass:\"text-center\"},[_c('b-button',{attrs:{\"variant\":\"success\",\"size\":\"lg\",\"disabled\":_vm.loading || !_vm.canProcessReturn},on:{\"click\":_vm.processReturn}},[(_vm.loading)?_c('b-spinner',{staticClass:\"mr-2\",attrs:{\"small\":\"\"}}):_c('feather-icon',{staticClass:\"mr-2\",attrs:{\"icon\":\"CheckCircleIcon\",\"size\":\"18\"}}),_vm._v(\" Process Return \")],1)],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"return-products-container\">\r\n    <div class=\"page-header\">\r\n      <h2 class=\"mb-0\">Return Products</h2>\r\n      <b-button variant=\"outline-secondary\" @click=\"goBack\" :disabled=\"loading\">\r\n        Back to POS\r\n      </b-button>\r\n    </div>\r\n\r\n    <!-- Ticket Search -->\r\n    <b-card class=\"mb-4\">\r\n      <h5 class=\"mb-3\">Enter Ticket Number</h5>\r\n      <b-row>\r\n        <b-col cols=\"12\" md=\"6\">\r\n          <b-input-group>\r\n            <b-form-input v-model=\"ticketNumber\" placeholder=\"Enter ticket number...\" @keyup.enter=\"loadTicket\"\r\n              :disabled=\"loading\" ref=\"ticketInput\" />\r\n            <b-input-group-append>\r\n              <b-button variant=\"primary\" @click=\"loadTicket\" :disabled=\"loading || !ticketNumber\">\r\n                <b-spinner v-if=\"loading\" small class=\"mr-1\" />\r\n                <feather-icon v-else icon=\"SearchIcon\"/>\r\n                Load Ticket\r\n              </b-button>\r\n            </b-input-group-append>\r\n          </b-input-group>\r\n        </b-col>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- Ticket Details -->\r\n    <b-card v-if=\"ticketData\" class=\"mb-4 ticket-details-card\">\r\n      <div class=\"d-flex align-items-center mb-3\">\r\n        <feather-icon icon=\"FileTextIcon\" size=\"20\" class=\"mr-2 text-primary\" />\r\n        <h5 class=\"mb-0\">Ticket Details</h5>\r\n      </div>\r\n      <b-row>\r\n        <b-col cols=\"12\" md=\"6\">\r\n          <div class=\"detail-item\">\r\n            <strong class=\"detail-label\">Ticket Number:</strong>\r\n            <span class=\"detail-value\">{{ ticketData.ticket.salesNumber }}</span>\r\n          </div>\r\n          <div class=\"detail-item\">\r\n            <strong class=\"detail-label\">Date:</strong>\r\n            <span class=\"detail-value\">{{ formatDate(ticketData.ticket.salesDate) }}</span>\r\n          </div>\r\n          <div class=\"detail-item\" v-if=\"ticketData.ticket.customer\">\r\n            <strong class=\"detail-label\">Customer:</strong>\r\n            <span class=\"detail-value\">{{ ticketData.ticket.customer.name }}</span>\r\n            <small class=\"text-muted ml-2\">({{ ticketData.ticket.customer.customerCode }})</small>\r\n          </div>\r\n          <div class=\"detail-item\" v-if=\"ticketData.ticket.createdByUser\">\r\n            <strong class=\"detail-label\">Cashier:</strong>\r\n            <span class=\"detail-value\">{{ ticketData.ticket.createdByUser.fullName || ticketData.ticket.createdByUser.username }}</span>\r\n          </div>\r\n        </b-col>\r\n        <b-col cols=\"12\" md=\"6\">\r\n          <div class=\"ticket-summary\">\r\n            <div class=\"summary-item\" v-if=\"ticketData.ticket.subtotal\">\r\n              <span class=\"summary-label\">Subtotal:</span>\r\n              <span class=\"summary-value\">{{ formatPrice(ticketData.ticket.subtotal) }} TND</span>\r\n            </div>\r\n            <div class=\"summary-item\" v-if=\"ticketData.ticket.taxAmount\">\r\n              <span class=\"summary-label\">Tax (VAT):</span>\r\n              <span class=\"summary-value\">{{ formatPrice(ticketData.ticket.taxAmount) }} TND</span>\r\n            </div>\r\n            <div class=\"summary-item\" v-if=\"ticketData.ticket.discountAmount\">\r\n              <span class=\"summary-label\">Discount:</span>\r\n              <span class=\"summary-value text-danger\">-{{ formatPrice(ticketData.ticket.discountAmount) }} TND</span>\r\n            </div>\r\n            <div class=\"summary-item total-amount\">\r\n              <span class=\"summary-label\"><strong>Total Amount (TTC):</strong></span>\r\n              <span class=\"summary-value\"><strong>{{ formatPrice(ticketData.ticket.totalAmount) }} TND</strong></span>\r\n            </div>\r\n          </div>\r\n          <div class=\"detail-item mt-2\" v-if=\"!ticketData.canReturn\">\r\n            <b-badge variant=\"danger\">This ticket is too old to be returned</b-badge>\r\n          </div>\r\n        </b-col>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- Return Items Selection -->\r\n    <b-card v-if=\"ticketData && ticketData.canReturn\" class=\"mb-4 return-items-card\">\r\n      <div class=\"d-flex align-items-center mb-3\">\r\n        <feather-icon icon=\"PackageIcon\" size=\"20\" class=\"mr-2 text-primary\" />\r\n        <h5 class=\"mb-0\">Select Items to Return</h5>\r\n      </div>\r\n      <b-table :items=\"ticketData.salesLines\" :fields=\"lineFields\" striped hover responsive class=\"return-items-table\">\r\n        <template #cell(item)=\"row\">\r\n          <div>\r\n            <strong>{{ row.item.item.name }}</strong>\r\n            <div class=\"small text-muted\">{{ row.item.item.itemCode }}</div>\r\n          </div>\r\n        </template>\r\n        <template #cell(originalQty)=\"row\">\r\n          <span class=\"badge badge-secondary\">{{ row.item.quantity }}</span>\r\n        </template>\r\n        <template #cell(remainingQty)=\"row\">\r\n          <span class=\"font-weight-bold\" :class=\"getRemainingQtyClass(row.item)\">\r\n            {{ row.item.remainingQuantity !== undefined ? row.item.remainingQuantity : row.item.quantity }}\r\n          </span>\r\n          <div v-if=\"row.item.returnedQuantity > 0\" class=\"small text-muted\">\r\n            ({{ row.item.returnedQuantity }} already returned)\r\n          </div>\r\n        </template>\r\n        <template #cell(unitPrice)=\"row\">\r\n          <div>\r\n            <strong>{{ formatPrice(row.item.unitPriceIncludingVat || row.item.unitPrice) }} TND</strong>\r\n            <div class=\"small text-muted\" v-if=\"row.item.vatPercent\">\r\n              <span class=\"text-info\">VAT: {{ row.item.vatPercent }}%</span>\r\n            </div>\r\n            <div class=\"small text-muted\" v-if=\"row.item.unitPriceIncludingVat && row.item.unitPrice\">\r\n              <span class=\"text-muted\">HT: {{ formatPrice(row.item.unitPrice) }} TND</span>\r\n            </div>\r\n          </div>\r\n        </template>\r\n        <template #cell(returnQty)=\"row\">\r\n          <b-form-input v-model.number=\"row.item.returnQuantity\" type=\"number\" :min=\"0\" :max=\"row.item.remainingQuantity || row.item.quantity\"\r\n            @input=\"onReturnQuantityChange(row.item)\" @blur=\"onReturnQuantityBlur(row.item)\"\r\n            @keyup.enter=\"onReturnQuantityBlur(row.item)\" :disabled=\"loading\" style=\"width: 100px;\"\r\n            :state=\"getReturnQtyState(row.item)\" class=\"return-qty-input\" />\r\n          <b-form-invalid-feedback v-if=\"row.item.returnQuantity > (row.item.remainingQuantity || row.item.quantity)\" :state=\"false\">\r\n            Cannot exceed {{ row.item.remainingQuantity !== undefined ? row.item.remainingQuantity : row.item.quantity }}\r\n          </b-form-invalid-feedback>\r\n        </template>\r\n        <template #cell(returnAmount)=\"row\">\r\n          <div>\r\n            <strong class=\"text-success\">{{ formatPrice(getReturnAmount(row.item)) }} TND</strong>\r\n            <div class=\"small text-muted\" v-if=\"row.item.vatAmount && row.item.returnQuantity > 0\">\r\n              <span class=\"text-info\">VAT: {{ formatPrice((row.item.vatAmount / row.item.quantity) * row.item.returnQuantity) }} TND</span>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </b-table>\r\n    </b-card>\r\n\r\n    <!-- Return Type Selection -->\r\n    <b-card v-if=\"ticketData && ticketData.canReturn && hasReturnItems\" class=\"mb-4\">\r\n      <h5 class=\"mb-3\">Return Type</h5>\r\n      <b-form-group>\r\n        <b-form-radio-group v-model=\"returnType\" :options=\"returnTypeOptions\" @change=\"onReturnTypeChange\" />\r\n      </b-form-group>\r\n      <b-alert v-if=\"returnType === 'SIMPLE_RETURN' && !ticketData.isSimpleReturnEnabled\" variant=\"warning\" show>\r\n        Simple return is not enabled. Please select Return Voucher.\r\n      </b-alert>\r\n    </b-card>\r\n\r\n    <!-- Return Summary -->\r\n    <b-card v-if=\"ticketData && ticketData.canReturn && hasReturnItems\" class=\"mb-4 return-summary-card\">\r\n      <div class=\"d-flex align-items-center mb-3\">\r\n        <feather-icon icon=\"CalculatorIcon\" size=\"20\" class=\"mr-2 text-primary\" />\r\n        <h5 class=\"mb-0\">Return Summary</h5>\r\n      </div>\r\n      <b-row>\r\n        <b-col cols=\"12\" md=\"6\" offset-md=\"6\">\r\n          <div class=\"return-summary\">\r\n            <div class=\"summary-row\">\r\n              <span class=\"summary-label\">Subtotal (HT):</span>\r\n              <span class=\"summary-value\">{{ formatPrice(totalReturnAmountHT) }} TND</span>\r\n            </div>\r\n            <div class=\"summary-row\" v-if=\"totalReturnVAT > 0\">\r\n              <span class=\"summary-label\">Tax (VAT):</span>\r\n              <span class=\"summary-value text-info\">{{ formatPrice(totalReturnVAT) }} TND</span>\r\n            </div>\r\n            <div class=\"summary-row total-return\">\r\n              <span class=\"summary-label\"><strong>Total Return Amount (TTC):</strong></span>\r\n              <span class=\"summary-value\"><strong class=\"text-success\">{{ formatPrice(totalReturnAmount) }} TND</strong></span>\r\n            </div>\r\n          </div>\r\n        </b-col>\r\n      </b-row>\r\n    </b-card>\r\n\r\n    <!-- Process Return Button -->\r\n    <div v-if=\"ticketData && ticketData.canReturn && hasReturnItems\" class=\"text-center\">\r\n      <b-button variant=\"success\" size=\"lg\" @click=\"processReturn\" :disabled=\"loading || !canProcessReturn\">\r\n        <b-spinner v-if=\"loading\" small class=\"mr-2\" />\r\n        <feather-icon v-else icon=\"CheckCircleIcon\" size=\"18\" class=\"mr-2\" />\r\n        Process Return\r\n      </b-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ToastificationContent from '@core/components/toastification/ToastificationContent.vue'\r\nimport ReceiptTemplate from '@/components/ReceiptTemplate.vue'\r\nimport JsBarcode from 'jsbarcode'\r\n\r\nexport default {\r\n  name: 'ReturnProducts',\r\n  data() {\r\n    return {\r\n      ticketNumber: '',\r\n      ticketData: null,\r\n      returnType: 'RETURN_VOUCHER',\r\n      loading: false,\r\n      lineFields: [\r\n        { key: 'item', label: 'Item' },\r\n        { key: 'originalQty', label: 'Purchased Qty', thClass: 'text-center', tdClass: 'text-center' },\r\n        { key: 'remainingQty', label: 'Remaining Qty', thClass: 'text-center', tdClass: 'text-center' },\r\n        { key: 'unitPrice', label: 'Unit Price (TTC)', thClass: 'text-right', tdClass: 'text-right' },\r\n        { key: 'returnQty', label: 'Return Qty', thClass: 'text-center', tdClass: 'text-center' },\r\n        { key: 'returnAmount', label: 'Return Amount (TTC)', thClass: 'text-right', tdClass: 'text-right' }\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    returnTypeOptions() {\r\n      const options = []\r\n      if (this.ticketData && this.ticketData.isSimpleReturnEnabled) {\r\n        options.push({ value: 'SIMPLE_RETURN', text: 'Simple Return (Cash Refund)' })\r\n      }\r\n      options.push({ value: 'RETURN_VOUCHER', text: 'Return Voucher' })\r\n      return options\r\n    },\r\n    hasReturnItems() {\r\n      if (!this.ticketData || !this.ticketData.salesLines) return false\r\n      const hasItems = this.ticketData.salesLines.some(line => {\r\n        const qty = parseFloat(line.returnQuantity)\r\n        if (isNaN(qty) || qty === null || qty === undefined) {\r\n          return false\r\n        }\r\n        const roundedQty = Math.round(qty)\r\n        return roundedQty > 0 && roundedQty <= line.quantity\r\n      })\r\n      return hasItems\r\n    },\r\n    totalReturnAmount() {\r\n      if (!this.ticketData || !this.ticketData.salesLines) return 0\r\n      return this.ticketData.salesLines.reduce((total, line) => {\r\n        let returnQty = parseFloat(line.returnQuantity) || 0\r\n        // Cap at remaining quantity for calculation\r\n        const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n        if (returnQty > maxReturnable) {\r\n          returnQty = maxReturnable\r\n        }\r\n        if (returnQty < 0) {\r\n          returnQty = 0\r\n        }\r\n        returnQty = Math.round(returnQty)\r\n        // Use TTC amount (lineTotalIncludingVat / quantity * returnQty)\r\n        const unitPriceTTC = line.unitPriceIncludingVat || line.unitPrice\r\n        return total + (returnQty * unitPriceTTC)\r\n      }, 0)\r\n    },\r\n    totalReturnAmountHT() {\r\n      if (!this.ticketData || !this.ticketData.salesLines) return 0\r\n      return this.ticketData.salesLines.reduce((total, line) => {\r\n        let returnQty = parseFloat(line.returnQuantity) || 0\r\n        const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n        if (returnQty > maxReturnable) {\r\n          returnQty = maxReturnable\r\n        }\r\n        if (returnQty < 0) {\r\n          returnQty = 0\r\n        }\r\n        returnQty = Math.round(returnQty)\r\n        // Calculate HT: (lineTotal / quantity) * returnQty\r\n        const unitPriceHT = line.unitPrice || 0\r\n        return total + (returnQty * unitPriceHT)\r\n      }, 0)\r\n    },\r\n    totalReturnVAT() {\r\n      return this.totalReturnAmount - this.totalReturnAmountHT\r\n    },\r\n    canProcessReturn() {\r\n      if (!this.hasReturnItems) return false\r\n      if (this.returnType === 'SIMPLE_RETURN' && !this.ticketData.isSimpleReturnEnabled) return false\r\n      return true\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      if (this.$refs.ticketInput) {\r\n        this.$refs.ticketInput.focus()\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    async loadTicket() {\r\n      if (!this.ticketNumber.trim()) {\r\n        this.$toast({\r\n          component: ToastificationContent,\r\n          props: {\r\n            title: 'Error',\r\n            icon: 'XIcon',\r\n            text: 'Please enter a ticket number',\r\n            variant: 'danger'\r\n          }\r\n        })\r\n        return\r\n      }\r\n\r\n      this.loading = true\r\n      try {\r\n        const response = await this.$http.get('/return-header/ticket-details', {\r\n          params: { ticketNumber: this.ticketNumber.trim() }\r\n        })\r\n\r\n        if (response.status === 200) {\r\n          this.ticketData = response.data\r\n\r\n          // Initialize return quantities using Vue.set to ensure reactivity\r\n          // The backend now returns only items with remainingQuantity > 0\r\n          if (this.ticketData.salesLines) {\r\n            this.ticketData.salesLines.forEach(line => {\r\n              this.$set(line, 'returnQuantity', 0)\r\n              // Ensure remainingQuantity is set (should come from backend)\r\n              if (line.remainingQuantity === undefined) {\r\n                // Fallback: if backend doesn't provide it, use original quantity\r\n                this.$set(line, 'remainingQuantity', line.quantity)\r\n              }\r\n            })\r\n          }\r\n\r\n          // Set default return type based on configuration\r\n          if (!this.ticketData.isSimpleReturnEnabled) {\r\n            this.returnType = 'RETURN_VOUCHER'\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading ticket:', error)\r\n        let errorMessage = 'Failed to load ticket. Please check the ticket number.'\r\n        if (error.response && error.response.data) {\r\n          errorMessage = error.response.data.message || error.response.data || errorMessage\r\n        }\r\n        this.$toast({\r\n          component: ToastificationContent,\r\n          props: {\r\n            title: 'Error',\r\n            icon: 'XIcon',\r\n            text: errorMessage,\r\n            variant: 'danger'\r\n          }\r\n        })\r\n        this.ticketData = null\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    onReturnQuantityChange(line) {\r\n      // Validate and fix quantity in real-time\r\n      let qty = parseFloat(line.returnQuantity)\r\n\r\n      // Handle NaN or invalid values\r\n      if (isNaN(qty) || qty === null || qty === undefined) {\r\n        qty = 0\r\n      }\r\n\r\n      // Get the maximum returnable quantity (remaining quantity)\r\n      const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n\r\n      // Ensure quantity doesn't exceed remaining returnable quantity\r\n      if (qty > maxReturnable) {\r\n        qty = maxReturnable\r\n        // Show warning\r\n        this.$nextTick(() => {\r\n          this.$toast({\r\n            component: ToastificationContent,\r\n            props: {\r\n              title: 'Validation',\r\n              icon: 'AlertCircleIcon',\r\n              text: `Return quantity cannot exceed remaining quantity (${maxReturnable})`,\r\n              variant: 'warning'\r\n            }\r\n          })\r\n        })\r\n      }\r\n\r\n      // Ensure quantity is not negative\r\n      if (qty < 0) {\r\n        qty = 0\r\n      }\r\n\r\n      // Round to integer\r\n      qty = Math.round(qty)\r\n\r\n      // Use Vue.set to ensure reactivity\r\n      this.$set(line, 'returnQuantity', qty)\r\n    },\r\n    onReturnQuantityBlur(line) {\r\n      // Final validation on blur/enter\r\n      let qty = parseFloat(line.returnQuantity)\r\n\r\n      if (isNaN(qty) || qty === null || qty === undefined) {\r\n        qty = 0\r\n      }\r\n\r\n      // Get the maximum returnable quantity (remaining quantity)\r\n      const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n\r\n      // Cap at remaining returnable quantity\r\n      if (qty > maxReturnable) {\r\n        qty = maxReturnable\r\n      }\r\n\r\n      if (qty < 0) {\r\n        qty = 0\r\n      }\r\n\r\n      qty = Math.round(qty)\r\n      this.$set(line, 'returnQuantity', qty)\r\n    },\r\n    getReturnQtyState(line) {\r\n      if (line.returnQuantity === null || line.returnQuantity === undefined) {\r\n        return null\r\n      }\r\n      const qty = parseFloat(line.returnQuantity)\r\n      if (isNaN(qty)) {\r\n        return false\r\n      }\r\n      // Get the maximum returnable quantity (remaining quantity)\r\n      const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n      if (qty < 0 || qty > maxReturnable) {\r\n        return false\r\n      }\r\n      return null\r\n    },\r\n    getReturnAmount(line) {\r\n      let returnQty = parseFloat(line.returnQuantity) || 0\r\n      // Get the maximum returnable quantity (remaining quantity)\r\n      const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n      // Cap at remaining returnable quantity\r\n      if (returnQty > maxReturnable) {\r\n        returnQty = maxReturnable\r\n      }\r\n      if (returnQty < 0) {\r\n        returnQty = 0\r\n      }\r\n      returnQty = Math.round(returnQty)\r\n      // Use TTC amount (unitPriceIncludingVat)\r\n      const unitPriceTTC = line.unitPriceIncludingVat || line.unitPrice\r\n      return returnQty * unitPriceTTC\r\n    },\r\n    getRemainingQtyClass(line) {\r\n      const remaining = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n      if (remaining === 0) {\r\n        return 'text-danger' // No items remaining to return\r\n      } else if (remaining < line.quantity) {\r\n        return 'text-warning' // Some items already returned\r\n      }\r\n      return 'text-success' // All items available\r\n    },\r\n    onReturnTypeChange() {\r\n      // Handle return type change if needed\r\n    },\r\n    async processReturn() {\r\n      if (!this.canProcessReturn) return\r\n\r\n      // Frontend validation before calling backend API\r\n      const validationErrors = []\r\n      const returnLines = []\r\n\r\n      for (const line of this.ticketData.salesLines) {\r\n        let returnQty = parseFloat(line.returnQuantity) || 0\r\n\r\n        // Validate return quantity\r\n        if (isNaN(returnQty)) {\r\n          validationErrors.push(`Invalid return quantity for ${line.item.name}`)\r\n          continue\r\n        }\r\n\r\n        // Round to integer\r\n        returnQty = Math.round(returnQty)\r\n\r\n        // Validate range\r\n        if (returnQty < 0) {\r\n          validationErrors.push(`Return quantity for ${line.item.name} cannot be negative`)\r\n          continue\r\n        }\r\n\r\n        // Get the maximum returnable quantity (remaining quantity)\r\n        const maxReturnable = line.remainingQuantity !== undefined ? line.remainingQuantity : line.quantity\r\n        \r\n        if (returnQty > maxReturnable) {\r\n          validationErrors.push(`Return quantity for ${line.item.name} (${returnQty}) cannot exceed remaining quantity (${maxReturnable})`)\r\n          continue\r\n        }\r\n\r\n        // Only add to return lines if quantity is greater than 0\r\n        if (returnQty > 0) {\r\n          returnLines.push({\r\n            salesLineId: line.id,\r\n            quantity: returnQty\r\n          })\r\n        }\r\n      }\r\n\r\n      // Show validation errors if any\r\n      if (validationErrors.length > 0) {\r\n        this.$toast({\r\n          component: ToastificationContent,\r\n          props: {\r\n            title: 'Validation Error',\r\n            icon: 'XIcon',\r\n            text: validationErrors.join('. '),\r\n            variant: 'danger'\r\n          }\r\n        })\r\n        return\r\n      }\r\n\r\n      if (returnLines.length === 0) {\r\n        this.$toast({\r\n          component: ToastificationContent,\r\n          props: {\r\n            title: 'Error',\r\n            icon: 'XIcon',\r\n            text: 'Please select at least one item to return',\r\n            variant: 'danger'\r\n          }\r\n        })\r\n        return\r\n      }\r\n\r\n      this.loading = true\r\n      try {\r\n        const request = {\r\n          ticketNumber: this.ticketNumber.trim(),\r\n          returnType: this.returnType,\r\n          returnLines: returnLines,\r\n          notes: ''\r\n        }\r\n\r\n        const response = await this.$http.post('/return-header/process-return', request)\r\n\r\n        if (response.status === 200) {\r\n          this.$toast({\r\n            component: ToastificationContent,\r\n            props: {\r\n              title: 'Success',\r\n              icon: 'CheckCircleIcon',\r\n              text: `Return ${response.data.returnNumber} processed successfully!`,\r\n              variant: 'success'\r\n            }\r\n          })\r\n\r\n\r\n          // If return voucher was created, show voucher info and print\r\n          if (this.returnType === 'RETURN_VOUCHER' && response.data.returnVoucher) {\r\n            this.$toast({\r\n              component: ToastificationContent,\r\n              props: {\r\n                title: 'Return Voucher Created',\r\n                icon: 'FileTextIcon',\r\n                text: `Voucher Number: ${response.data.returnVoucher.voucherNumber}, Amount: ${this.formatPrice(response.data.returnVoucher.voucherAmount)} TND`,\r\n                variant: 'info'\r\n              }\r\n            })\r\n\r\n            // Print the voucher as a ticket\r\n            this.printVoucherReceipt(response.data)\r\n          }\r\n\r\n          // Reset form\r\n          setTimeout(() => {\r\n            this.ticketNumber = ''\r\n            this.ticketData = null\r\n            this.returnType = 'RETURN_VOUCHER'\r\n            if (this.$refs.ticketInput) {\r\n              this.$refs.ticketInput.focus()\r\n            }\r\n          }, 2000)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error processing return:', error)\r\n        let errorMessage = 'Failed to process return. Please try again.'\r\n        if (error.response && error.response.data) {\r\n          errorMessage = error.response.data.message || error.response.data || errorMessage\r\n        }\r\n        this.$toast({\r\n          component: ToastificationContent,\r\n          props: {\r\n            title: 'Error',\r\n            icon: 'XIcon',\r\n            text: errorMessage,\r\n            variant: 'danger'\r\n          }\r\n        })\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    formatDate(dateStr) {\r\n      if (!dateStr) return '-'\r\n      const date = new Date(dateStr)\r\n      return date.toLocaleString()\r\n    },\r\n    formatPrice(price) {\r\n      if (!price) return '0.00'\r\n      return parseFloat(price).toFixed(2)\r\n    },\r\n    goBack() {\r\n      this.$router.push({ name: 'pos-item-selection' })\r\n    },\r\n    async printVoucherReceipt(returnData) {\r\n      if (!returnData || !returnData.returnVoucher) {\r\n        console.error('No voucher data to print')\r\n        return\r\n      }\r\n\r\n      // Prepare voucher data in the same format as sale data for ReceiptTemplate\r\n      // The backend returns returnLines directly in the response, not nested\r\n      const returnLines = returnData.returnLines || []\r\n\r\n      const voucherData = {\r\n        salesNumber: returnData.returnVoucher.voucherNumber,\r\n        salesDate: returnData.returnVoucher.voucherDate,\r\n        totalAmount: returnData.returnVoucher.voucherAmount,\r\n        subtotal: returnData.returnVoucher.voucherAmount,\r\n        taxAmount: 0,\r\n        discountAmount: 0,\r\n        paidAmount: returnData.returnVoucher.voucherAmount,\r\n        changeAmount: 0,\r\n        notes: `Return Voucher - Original Ticket: ${returnData.originalSalesHeader?.salesNumber || 'N/A'}`,\r\n        createdByUser: {\r\n          fullName: 'System',\r\n          username: 'System'\r\n        },\r\n        cashierSession: null,\r\n        customer: returnData.returnVoucher.customerName ? {\r\n          name: returnData.returnVoucher.customerName\r\n        } : null,\r\n        salesLines: returnLines.map(line => ({\r\n          item: {\r\n            name: line.item?.name || 'Return Item',\r\n            itemCode: line.item?.itemCode || 'N/A'\r\n          },\r\n          quantity: line.quantity || 0,\r\n          lineTotal: (line.unitPrice || 0) * (line.quantity || 0),\r\n          unitPrice: line.unitPrice || 0\r\n        })),\r\n        paymentHeaders: [{\r\n          paymentMethod: {\r\n            name: 'Return Voucher'\r\n          },\r\n          totalAmount: returnData.returnVoucher.voucherAmount,\r\n          paymentReference: returnData.returnVoucher.voucherNumber\r\n        }]\r\n      }\r\n\r\n      // Add voucher-specific information\r\n      voucherData.isVoucher = true\r\n      voucherData.voucherInfo = {\r\n        voucherNumber: returnData.returnVoucher.voucherNumber,\r\n        expiryDate: returnData.returnVoucher.expiryDate,\r\n        originalTicket: returnData.originalSalesHeader?.salesNumber || 'N/A',\r\n        returnNumber: returnData.returnNumber\r\n      }\r\n\r\n      console.log('Printing voucher receipt with data:', voucherData)\r\n\r\n      // Use Vue to create component instance\r\n      const Vue = this.$root.constructor || this.$options._base\r\n      const ReceiptComponent = Vue.extend(ReceiptTemplate)\r\n\r\n      // Create component instance\r\n      const instance = new ReceiptComponent({\r\n        parent: this,\r\n        propsData: {\r\n          saleData: voucherData,\r\n          isVoucher: true\r\n        }\r\n      })\r\n\r\n      // Mount the component\r\n      instance.$mount()\r\n\r\n      // Create a new window for printing\r\n      const printWindow = window.open('', '_blank')\r\n      if (!printWindow) {\r\n        this.$toast({\r\n          component: ToastificationContent,\r\n          props: {\r\n            title: 'Print Error',\r\n            icon: 'XIcon',\r\n            text: 'Please allow popups to print vouchers',\r\n            variant: 'warning'\r\n          }\r\n        })\r\n        return\r\n      }\r\n\r\n      // Wait for component to mount and generate barcode\r\n      await this.$nextTick()\r\n      await new Promise(resolve => setTimeout(resolve, 200))\r\n      \r\n      // Generate barcode in the component if voucher_number exists\r\n      const barcodeValue = returnData.returnVoucher.voucherNumber || null\r\n      if (barcodeValue && instance.$el) {\r\n        try {\r\n          const svgElement = instance.$el.querySelector('.barcode-svg')\r\n          if (svgElement) {\r\n            JsBarcode(svgElement, barcodeValue, {\r\n              format: 'CODE128',\r\n              width: 1.5,\r\n              height: 40,\r\n              displayValue: false,\r\n              margin: 5,\r\n              background: '#ffffff',\r\n              lineColor: '#000000'\r\n            })\r\n          }\r\n        } catch (error) {\r\n          console.error('Error generating barcode:', error)\r\n        }\r\n      }\r\n      \r\n      // Write receipt HTML to new window\r\n      printWindow.document.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n          <title>Return Voucher - ${returnData.returnVoucher.voucherNumber}</title>\r\n          <style>\r\n            @page {\r\n              size: 80mm auto;\r\n              margin: 0;\r\n            }\r\n            body {\r\n              margin: 0;\r\n              padding: 10mm;\r\n              font-family: 'Courier New', monospace;\r\n              font-size: 12px;\r\n              line-height: 1.4;\r\n              background: white;\r\n              color: black;\r\n            }\r\n            .receipt-template {\r\n              width: 100%;\r\n              max-width: 80mm;\r\n            }\r\n            .receipt-header { margin-bottom: 15px; }\r\n            .receipt-header h2 { font-size: 16px; margin: 5px 0; font-weight: bold; text-align: center; }\r\n            .receipt-header h3 { font-size: 14px; margin: 5px 0; font-weight: bold; text-align: center; }\r\n            .receipt-divider { margin: 8px 0; text-align: center; }\r\n            .receipt-info, .receipt-items, .receipt-totals, .receipt-payments { margin-bottom: 10px; }\r\n            .receipt-row { display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 12px; }\r\n            .receipt-row.total { font-weight: bold; font-size: 14px; margin-top: 8px; }\r\n            .receipt-row .label { text-align: left; }\r\n            .receipt-row .value { text-align: right; font-weight: bold; }\r\n            .item-name { flex: 2; text-align: left; }\r\n            .item-qty { flex: 0.5; text-align: center; }\r\n            .item-total { flex: 1; text-align: right; }\r\n            .item-code { font-size: 10px; color: #666; margin-left: 10px; margin-bottom: 6px; }\r\n            .receipt-section-header { font-weight: bold; text-align: center; margin: 8px 0; }\r\n            .receipt-footer { margin-top: 20px; text-align: center; font-size: 11px; }\r\n            .receipt-item { margin-bottom: 8px; }\r\n            .payment-entry { margin-bottom: 8px; }\r\n            .voucher-badge {\r\n              background: #007bff;\r\n              color: white;\r\n              font-weight: bold;\r\n              text-align: center;\r\n              padding: 8px;\r\n              margin: 10px 0;\r\n              font-size: 14px;\r\n              border: 2px solid #000;\r\n            }\r\n            .receipt-barcode { margin: 15px 0; text-align: center; }\r\n            .barcode-container { display: flex; justify-content: center; align-items: center; margin: 10px 0; }\r\n            .barcode-svg { max-width: 100%; height: auto; }\r\n            .barcode-text { font-size: 11px; font-weight: bold; margin-top: 5px; letter-spacing: 1px; text-align: center; }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          ${instance.$el.outerHTML}\r\n        </body>\r\n        </html>\r\n      `)\r\n\r\n      printWindow.document.close()\r\n\r\n      // Wait for content to load and barcode to generate, then print\r\n      setTimeout(() => {\r\n        printWindow.focus()\r\n        printWindow.print()\r\n\r\n        // Close window after printing\r\n        setTimeout(() => {\r\n          printWindow.close()\r\n          if (instance && instance.$el) {\r\n            instance.$destroy()\r\n          }\r\n        }, 1000)\r\n      }, 500)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.return-products-container {\r\n  padding: 20px;\r\n}\r\n\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.detail-item {\r\n  margin-bottom: 12px;\r\n  display: flex;\r\n  align-items: baseline;\r\n}\r\n\r\n.detail-label {\r\n  min-width: 120px;\r\n  color: #6c757d;\r\n}\r\n\r\n.detail-value {\r\n  color: #212529;\r\n  font-weight: 500;\r\n}\r\n\r\n.ticket-summary {\r\n  background: #f8f9fa;\r\n  padding: 15px;\r\n  border-radius: 5px;\r\n  border: 1px solid #dee2e6;\r\n}\r\n\r\n.summary-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 6px 0;\r\n  border-bottom: 1px solid #e9ecef;\r\n}\r\n\r\n.summary-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.summary-item.total-amount {\r\n  border-top: 2px solid #28a745;\r\n  border-bottom: 2px solid #28a745;\r\n  margin-top: 8px;\r\n  padding-top: 10px;\r\n  padding-bottom: 10px;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.summary-label {\r\n  color: #6c757d;\r\n}\r\n\r\n.summary-value {\r\n  font-weight: 600;\r\n  color: #212529;\r\n}\r\n\r\n.return-summary {\r\n  background: #f8f9fa;\r\n  padding: 15px;\r\n  border-radius: 5px;\r\n  border: 1px solid #dee2e6;\r\n}\r\n\r\n.summary-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 8px 0;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.summary-row.total-return {\r\n  border-top: 2px solid #28a745;\r\n  border-bottom: 2px solid #28a745;\r\n  margin-top: 10px;\r\n  padding-top: 10px;\r\n  padding-bottom: 10px;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.ticket-details-card,\r\n.return-items-card,\r\n.return-summary-card {\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n}\r\n\r\n.return-items-table {\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.return-qty-input {\r\n  text-align: center;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReturnProducts.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReturnProducts.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ReturnProducts.vue?vue&type=template&id=32cca83c&scoped=true\"\nimport script from \"./ReturnProducts.vue?vue&type=script&lang=js\"\nexport * from \"./ReturnProducts.vue?vue&type=script&lang=js\"\nimport style0 from \"./ReturnProducts.vue?vue&type=style&index=0&id=32cca83c&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"32cca83c\",\n  null\n  \n)\n\nexport default component.exports","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nfunction _createForOfIteratorHelper(r, e) {\n  var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (!t) {\n    if (Array.isArray(r) || (t = unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) {\n      t && (r = t);\n      var _n = 0,\n        F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          return _n >= r.length ? {\n            done: !0\n          } : {\n            done: !1,\n            value: r[_n++]\n          };\n        },\n        e: function e(r) {\n          throw r;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var o,\n    a = !0,\n    u = !1;\n  return {\n    s: function s() {\n      t = t.call(r);\n    },\n    n: function n() {\n      var r = t.next();\n      return a = r.done, r;\n    },\n    e: function e(r) {\n      u = !0, o = r;\n    },\n    f: function f() {\n      try {\n        a || null == t[\"return\"] || t[\"return\"]();\n      } finally {\n        if (u) throw o;\n      }\n    }\n  };\n}\nexport { _createForOfIteratorHelper as default };","var aFunction = require('../internals/a-function');\nvar toObject = require('../internals/to-object');\nvar IndexedObject = require('../internals/indexed-object');\nvar toLength = require('../internals/to-length');\n\n// `Array.prototype.{ reduce, reduceRight }` methods implementation\nvar createMethod = function (IS_RIGHT) {\n  return function (that, callbackfn, argumentsLength, memo) {\n    aFunction(callbackfn);\n    var O = toObject(that);\n    var self = IndexedObject(O);\n    var length = toLength(O.length);\n    var index = IS_RIGHT ? length - 1 : 0;\n    var i = IS_RIGHT ? -1 : 1;\n    if (argumentsLength < 2) while (true) {\n      if (index in self) {\n        memo = self[index];\n        index += i;\n        break;\n      }\n      index += i;\n      if (IS_RIGHT ? index < 0 : length <= index) {\n        throw TypeError('Reduce of empty array with no initial value');\n      }\n    }\n    for (;IS_RIGHT ? index >= 0 : length > index; index += i) if (index in self) {\n      memo = callbackfn(memo, self[index], index, O);\n    }\n    return memo;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.reduce` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n  left: createMethod(false),\n  // `Array.prototype.reduceRight` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.reduceright\n  right: createMethod(true)\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReturnProducts.vue?vue&type=style&index=0&id=32cca83c&prod&scoped=true&lang=css\""],"sourceRoot":""}