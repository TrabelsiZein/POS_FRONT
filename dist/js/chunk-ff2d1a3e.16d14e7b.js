(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff2d1a3e"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},1421:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"returns-management-container"},[r("div",{staticClass:"page-header"},[r("h2",{staticClass:"mb-0"},[t._v("Returns Management")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.loadReturns}},[r("feather-icon",{attrs:{icon:"RefreshCwIcon",size:"16"}}),t._v(" Refresh ")],1)],1),r("b-card",{staticClass:"mb-2"},[r("div",{attrs:{role:"button",tabindex:"0"},on:{click:t.toggleFilters,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toggleFilters(e)}}},[r("div",{staticClass:"d-flex align-items-center justify-content-between"},[r("div",{staticClass:"d-flex align-items-center"},[r("feather-icon",{staticClass:"mr-2 text-primary",attrs:{icon:"FilterIcon",size:"18"}}),r("h6",{staticClass:"mb-0 text-primary font-weight-bold"},[t._v(" Filters "),r("span",{staticClass:"text-muted font-weight-normal ml-2"},[t._v("(Total: "+t._s(t.totalRows)+" "+t._s(1===t.totalRows?"return":"returns")+")")])])],1),r("feather-icon",{staticClass:"text-primary",attrs:{icon:t.filtersExpanded?"ChevronUpIcon":"ChevronDownIcon",size:"20"}})],1)]),r("b-collapse",{attrs:{id:"filters-collapse"},model:{value:t.filtersExpanded,callback:function(e){t.filtersExpanded=e},expression:"filtersExpanded"}},[r("div",{staticClass:"pt-2"},[r("b-row",[r("b-col",{staticClass:"mb-2",attrs:{cols:"12",sm:"6",md:"6",lg:"6"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Search","label-for":"search-input"}},[r("b-input-group",[r("b-input-group-prepend",[r("b-input-group-text",{staticClass:"bg-white"},[r("feather-icon",{attrs:{icon:"SearchIcon",size:"16"}})],1)],1),r("b-form-input",{attrs:{id:"search-input",placeholder:"Search by return number, ticket number, voucher number..."},on:{input:t.onFilterChange},model:{value:t.filters.search,callback:function(e){t.$set(t.filters,"search",e)},expression:"filters.search"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"outline-secondary",disabled:!t.filters.search},on:{click:t.clearSearch}},[r("feather-icon",{attrs:{icon:"XIcon",size:"14"}})],1)],1)],1)],1)],1),r("b-col",{staticClass:"mb-2",attrs:{cols:"12",sm:"6",md:"3",lg:"3"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Date From","label-for":"date-from"}},[r("b-input-group",[r("b-input-group-prepend",[r("b-input-group-text",{staticClass:"bg-white"},[r("feather-icon",{attrs:{icon:"CalendarIcon",size:"16"}})],1)],1),r("b-form-input",{attrs:{id:"date-from",type:"date"},on:{input:t.onFilterChange},model:{value:t.filters.dateFrom,callback:function(e){t.$set(t.filters,"dateFrom",e)},expression:"filters.dateFrom"}})],1)],1)],1),r("b-col",{staticClass:"mb-2",attrs:{cols:"12",sm:"6",md:"3",lg:"3"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Date To","label-for":"date-to"}},[r("b-input-group",[r("b-input-group-prepend",[r("b-input-group-text",{staticClass:"bg-white"},[r("feather-icon",{attrs:{icon:"CalendarIcon",size:"16"}})],1)],1),r("b-form-input",{attrs:{id:"date-to",type:"date"},on:{input:t.onFilterChange},model:{value:t.filters.dateTo,callback:function(e){t.$set(t.filters,"dateTo",e)},expression:"filters.dateTo"}})],1)],1)],1)],1),r("b-row",[r("b-col",{staticClass:"mb-2",attrs:{cols:"12",sm:"6",md:"3",lg:"3"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Return Type","label-for":"return-type-filter"}},[r("b-input-group",[r("b-input-group-prepend",[r("b-input-group-text",{staticClass:"bg-white"},[r("feather-icon",{attrs:{icon:"TagIcon",size:"16"}})],1)],1),r("b-form-select",{attrs:{id:"return-type-filter",options:t.returnTypeOptions},on:{input:t.onFilterChange},model:{value:t.filters.returnType,callback:function(e){t.$set(t.filters,"returnType",e)},expression:"filters.returnType"}})],1)],1)],1),r("b-col",{staticClass:"mb-2",attrs:{cols:"12",sm:"6",md:"3",lg:"3"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Voucher Status","label-for":"voucher-status-filter"}},[r("b-input-group",[r("b-input-group-prepend",[r("b-input-group-text",{staticClass:"bg-white"},[r("feather-icon",{attrs:{icon:"CreditCardIcon",size:"16"}})],1)],1),r("b-form-select",{attrs:{id:"voucher-status-filter",options:t.voucherStatusOptions},on:{input:t.onFilterChange},model:{value:t.filters.voucherStatus,callback:function(e){t.$set(t.filters,"voucherStatus",e)},expression:"filters.voucherStatus"}})],1)],1)],1),r("b-col",{staticClass:"mb-2",attrs:{cols:"12",sm:"6",md:"3",lg:"3"}},[r("b-form-group",{staticClass:"mb-0",attrs:{label:"Sync Status","label-for":"sync-status-filter"}},[r("b-input-group",[r("b-input-group-prepend",[r("b-input-group-text",{staticClass:"bg-white"},[r("feather-icon",{attrs:{icon:"CloudIcon",size:"16"}})],1)],1),r("b-form-select",{attrs:{id:"sync-status-filter",options:t.syncStatusOptions},on:{input:t.onFilterChange},model:{value:t.filters.syncStatus,callback:function(e){t.$set(t.filters,"syncStatus",e)},expression:"filters.syncStatus"}})],1)],1)],1)],1)],1)])],1),r("b-card",[r("b-table",{staticClass:"cursor-pointer",attrs:{items:t.returns,fields:t.returnFields,striped:"",hover:"",responsive:"",busy:t.loading,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"show-empty":""},on:{"row-clicked":t.viewReturnDetails},scopedSlots:t._u([{key:"table-busy",fn:function(){return[r("div",{staticClass:"text-center text-danger my-2"},[r("b-spinner",{staticClass:"align-middle"}),r("strong",[t._v(" Loading...")])],1)]},proxy:!0},{key:"empty",fn:function(){return[r("div",{staticClass:"text-center py-4"},[r("p",{staticClass:"text-muted"},[t._v("No returns found")])])]},proxy:!0},{key:"cell(returnNumber)",fn:function(e){return[r("strong",[t._v(t._s(e.item.returnNumber))])]}},{key:"cell(returnDate)",fn:function(e){return[t._v(" "+t._s(t.formatDate(e.item.returnDate))+" ")]}},{key:"cell(returnType)",fn:function(e){return[r("b-badge",{attrs:{variant:"SIMPLE_RETURN"===e.item.returnType?"danger":"info"}},[t._v(" "+t._s("SIMPLE_RETURN"===e.item.returnType?"Simple Return":"Return Voucher")+" ")])]}},{key:"cell(totalReturnAmount)",fn:function(e){return[r("strong",[t._v(t._s(t.formatPrice(e.item.totalReturnAmount))+" TND")])]}},{key:"cell(originalTicket)",fn:function(e){return[e.item.originalSalesHeader?r("span",[t._v(" "+t._s(e.item.originalSalesHeader.salesNumber)+" ")]):r("span",{staticClass:"text-muted"},[t._v("N/A")])]}},{key:"cell(voucherInfo)",fn:function(e){return[e.item.returnVoucher?r("div",[r("div",[r("strong",[t._v(t._s(e.item.returnVoucher.voucherNumber))])]),r("div",{staticClass:"small text-muted"},["PENDING"===e.item.returnVoucher.status?r("span",[t._v(" Remaining: "+t._s(t.formatPrice(t.getRemainingAmount(e.item.returnVoucher)))+" TND ")]):t._e(),r("b-badge",{staticClass:"mt-1",attrs:{variant:t.getVoucherStatusVariant(e.item.returnVoucher.status)}},[t._v(" "+t._s(e.item.returnVoucher.status)+" ")])],1)]):r("span",{staticClass:"text-muted"},[t._v("-")])]}},{key:"cell(synchronizationStatus)",fn:function(e){return[r("div",{staticClass:"sync-status-cell"},[r("b-badge",{staticClass:"sync-badge",attrs:{variant:t.getSyncStatusVariant(e.item.synchronizationStatus)}},[r("feather-icon",{staticClass:"mr-1",attrs:{icon:t.getSyncStatusIcon(e.item.synchronizationStatus),size:"12"}}),t._v(" "+t._s(t.formatSyncStatus(e.item.synchronizationStatus))+" ")],1),e.item.erpNo?r("small",{staticClass:"text-muted d-block mt-1"},[t._v(" ERP: "+t._s(e.item.erpNo)+" ")]):t._e()],1)]}}])}),r("div",{staticClass:"mt-3"},[r("b-row",{attrs:{"align-v":"center"}},[r("b-col",{staticClass:"mb-2 mb-md-0",attrs:{cols:"12",md:"6"}},[r("div",{staticClass:"d-flex align-items-center"},[r("label",{staticClass:"mr-2 mb-0",attrs:{for:"per-page-select"}},[t._v("Items per page:")]),r("b-form-select",{staticStyle:{width:"auto"},attrs:{id:"per-page-select",options:t.perPageOptions,size:"sm"},on:{change:t.onPerPageChange},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)]),r("b-col",{attrs:{cols:"12",md:"6"}},[r("div",{staticClass:"text-center text-md-right"},[r("small",{staticClass:"text-muted"},[t._v(" Showing "+t._s(t.startIndex)+" to "+t._s(t.endIndex)+" of "+t._s(t.totalRows)+" returns ")])])])],1),r("div",{staticClass:"d-flex justify-content-center mt-2"},[r("b-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"center"},on:{change:t.onPageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),r("b-modal",{attrs:{id:"return-details-modal",title:"Return Details",size:"xl","hide-footer":"",scrollable:""},model:{value:t.showDetailsModal,callback:function(e){t.showDetailsModal=e},expression:"showDetailsModal"}},[t.selectedReturn?r("div",[r("b-card",{staticClass:"mb-3"},[r("h5",{staticClass:"mb-3"},[t._v("Return Information")]),r("b-row",[r("b-col",{attrs:{cols:"12",md:"6"}},[r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Return Number:")]),r("span",{staticClass:"detail-value"},[r("strong",[t._v(t._s(t.selectedReturn.returnNumber))])])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Return Date:")]),r("span",{staticClass:"detail-value"},[t._v(t._s(t.formatDate(t.selectedReturn.returnDate)))])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Return Type:")]),r("span",{staticClass:"detail-value"},[r("b-badge",{attrs:{variant:"SIMPLE_RETURN"===t.selectedReturn.returnType?"danger":"info"}},[t._v(" "+t._s("SIMPLE_RETURN"===t.selectedReturn.returnType?"Simple Return":"Return Voucher")+" ")])],1)]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Total Amount:")]),r("span",{staticClass:"detail-value"},[r("strong",[t._v(t._s(t.formatPrice(t.selectedReturn.totalReturnAmount))+" TND")])])])]),r("b-col",{attrs:{cols:"12",md:"6"}},[t.selectedReturn.originalSalesHeader?r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Original Ticket:")]),r("span",{staticClass:"detail-value"},[r("strong",[t._v(t._s(t.selectedReturn.originalSalesHeader.salesNumber))]),r("br"),r("small",{staticClass:"text-muted"},[t._v(t._s(t.formatDate(t.selectedReturn.originalSalesHeader.salesDate)))])])]):t._e(),t.selectedReturn.notes?r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Notes:")]),r("span",{staticClass:"detail-value"},[t._v(t._s(t.selectedReturn.notes))])]):t._e()])],1)],1),r("b-card",{staticClass:"mb-3 sync-info-card"},[r("div",{staticClass:"d-flex align-items-center mb-3"},[r("feather-icon",{staticClass:"mr-2 text-primary",attrs:{icon:"CloudIcon",size:"20"}}),r("h5",{staticClass:"mb-0"},[t._v("ERP Synchronization")])],1),r("b-row",[r("b-col",{attrs:{md:"6"}},[r("div",{staticClass:"sync-detail-item"},[r("label",{staticClass:"sync-label"},[t._v("Synchronization Status")]),r("div",{staticClass:"sync-value"},[r("b-badge",{staticClass:"sync-badge-large",attrs:{variant:t.getSyncStatusVariant(t.selectedReturn.synchronizationStatus)}},[r("feather-icon",{staticClass:"mr-1",attrs:{icon:t.getSyncStatusIcon(t.selectedReturn.synchronizationStatus),size:"14"}}),t._v(" "+t._s(t.formatSyncStatus(t.selectedReturn.synchronizationStatus))+" ")],1)],1)])]),r("b-col",{attrs:{md:"6"}},[r("div",{staticClass:"sync-detail-item"},[r("label",{staticClass:"sync-label"},[t._v("ERP Document Number")]),r("div",{staticClass:"sync-value"},[t.selectedReturn.erpNo?r("code",{staticClass:"erp-number"},[t._v(t._s(t.selectedReturn.erpNo))]):r("span",{staticClass:"text-muted"},[t._v("Not synchronized")])])])])],1),t.selectedReturn.returnLines?r("div",{staticClass:"mt-3"},[r("div",{staticClass:"sync-summary"},[r("small",{staticClass:"text-muted"},[t._v(" Lines synchronized: "),r("strong",[t._v(t._s(t.getSyncedLinesCount(t.selectedReturn.returnLines))+" / "+t._s(t.selectedReturn.returnLines.length))])])])]):t._e()],1),t.selectedReturn.returnVoucher?r("b-card",{staticClass:"mb-3"},[r("h5",{staticClass:"mb-3"},[t._v("Voucher Information")]),r("b-row",[r("b-col",{attrs:{cols:"12",md:"6"}},[r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Voucher Number:")]),r("span",{staticClass:"detail-value"},[r("strong",[t._v(t._s(t.selectedReturn.returnVoucher.voucherNumber))])])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Voucher Amount:")]),r("span",{staticClass:"detail-value"},[r("strong",[t._v(t._s(t.formatPrice(t.selectedReturn.returnVoucher.voucherAmount))+" TND")])])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Used Amount:")]),r("span",{staticClass:"detail-value"},[t._v(t._s(t.formatPrice(t.selectedReturn.returnVoucher.usedAmount||0))+" TND")])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Remaining Amount:")]),r("span",{staticClass:"detail-value"},[r("strong",{staticClass:"text-success"},[t._v(t._s(t.formatPrice(t.getRemainingAmount(t.selectedReturn.returnVoucher)))+" TND")])])])]),r("b-col",{attrs:{cols:"12",md:"6"}},[r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Issue Date:")]),r("span",{staticClass:"detail-value"},[t._v(t._s(t.formatDate(t.selectedReturn.returnVoucher.voucherDate)))])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Expiry Date:")]),r("span",{staticClass:"detail-value"},[r("span",{class:{"text-danger":t.isVoucherExpired(t.selectedReturn.returnVoucher)}},[t._v(" "+t._s(t.formatDate(t.selectedReturn.returnVoucher.expiryDate))+" ")])])]),r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Status:")]),r("span",{staticClass:"detail-value"},[r("b-badge",{attrs:{variant:t.getVoucherStatusVariant(t.selectedReturn.returnVoucher.status)}},[t._v(" "+t._s(t.selectedReturn.returnVoucher.status)+" ")])],1)]),t.selectedReturn.returnVoucher.customerName?r("div",{staticClass:"detail-row"},[r("span",{staticClass:"detail-label"},[t._v("Customer:")]),r("span",{staticClass:"detail-value"},[t._v(t._s(t.selectedReturn.returnVoucher.customerName))])]):t._e()])],1)],1):t._e(),r("b-card",[r("h5",{staticClass:"mb-3"},[t._v("Returned Items")]),r("b-table",{attrs:{items:t.selectedReturn.returnLines||[],fields:t.returnLineFields,small:"",striped:"",responsive:""},scopedSlots:t._u([{key:"cell(item)",fn:function(e){return[r("div",[r("strong",[t._v(t._s(e.item.item?e.item.item.name:"N/A"))]),e.item.item&&e.item.item.itemCode?r("div",{staticClass:"small text-muted"},[t._v(" Code: "+t._s(e.item.item.itemCode)+" ")]):t._e()])]}},{key:"cell(quantity)",fn:function(e){return[t._v(" "+t._s(e.item.quantity)+" ")]}},{key:"cell(unitPrice)",fn:function(e){return[t._v(" "+t._s(t.formatPrice(e.item.unitPrice))+" TND ")]}},{key:"cell(lineTotal)",fn:function(e){return[r("strong",[t._v(t._s(t.formatPrice(e.item.lineTotalIncludingVat||e.item.lineTotal))+" TND")])]}},{key:"cell(synched)",fn:function(e){return[r("b-badge",{staticClass:"sync-indicator",attrs:{variant:t.isSynched(e.item.synched)?"success":"secondary"}},[r("feather-icon",{staticClass:"mr-1",attrs:{icon:t.isSynched(e.item.synched)?"CheckIcon":"XIcon",size:"12"}}),t._v(" "+t._s(t.isSynched(e.item.synched)?"Synced":"Not Synced")+" ")],1)]}}],null,!1,1390383645)})],1),r("div",{staticClass:"text-right mt-3"},["RETURN_VOUCHER"===t.selectedReturn.returnType&&t.selectedReturn.returnVoucher?r("b-button",{staticClass:"mr-2",attrs:{variant:"success"},on:{click:function(e){return t.printVoucher(t.selectedReturn)}}},[r("feather-icon",{staticClass:"mr-1",attrs:{icon:"PrinterIcon",size:"16"}}),t._v(" Print Voucher ")],1):t._e(),r("b-button",{attrs:{variant:"secondary"},on:{click:function(e){t.showDetailsModal=!1}}},[t._v(" Close ")])],1)],1):t._e()])],1)},a=[],s=r("5530"),i=r("c7eb"),o=r("1da1"),l=(r("99af"),r("4de4"),r("caad"),r("a15b9"),r("d81d"),r("fb6a"),r("4e82"),r("b0c0"),r("b680"),r("d3b7"),r("ac1f"),r("2532"),r("841c"),r("223c")),c=r("475a"),u=r("62c5"),d=r.n(u),m=r("c1df"),p=r.n(m),f={name:"ReturnsManagement",data:function(){var t=new Date,e=t.toISOString().split("T")[0];return{returns:[],loading:!1,selectedReturn:null,showDetailsModal:!1,sortBy:"returnDate",sortDesc:!0,currentPage:1,perPage:10,perPageOptions:[{value:10,text:"10"},{value:20,text:"20"},{value:50,text:"50"},{value:100,text:"100"}],totalRows:0,filters:{search:"",dateFrom:e,dateTo:e,returnType:null,voucherStatus:null,syncStatus:"all"},filtersExpanded:!1,returnFields:[{key:"returnNumber",label:"Return #",sortable:!0},{key:"returnDate",label:"Date",sortable:!0},{key:"returnType",label:"Type",sortable:!0},{key:"totalReturnAmount",label:"Amount",sortable:!0},{key:"originalTicket",label:"Original Ticket",sortable:!1},{key:"voucherInfo",label:"Voucher Info",sortable:!1},{key:"synchronizationStatus",label:"Sync Status",sortable:!0}],returnLineFields:[{key:"item",label:"Item"},{key:"quantity",label:"Qty"},{key:"unitPrice",label:"Unit Price"},{key:"lineTotal",label:"Total TTC"},{key:"synched",label:"Synced",class:"text-center"}],returnTypeOptions:[{value:null,text:"All Types"},{value:"SIMPLE_RETURN",text:"Simple Return"},{value:"RETURN_VOUCHER",text:"Return Voucher"}],voucherStatusOptions:[{value:null,text:"All Statuses"},{value:"PENDING",text:"Pending"},{value:"USED",text:"Used"},{value:"EXPIRED",text:"Expired"}],syncStatusOptions:[{value:"all",text:"All"},{value:"NOT_SYNCHED",text:"Not Synced"},{value:"PARTIALLY_SYNCHED",text:"Partially Synced"},{value:"TOTALLY_SYNCHED",text:"Totally Synced"}]}},computed:{startIndex:function(){return 0===this.totalRows?0:(this.currentPage-1)*this.perPage+1},endIndex:function(){return Math.min(this.currentPage*this.perPage,this.totalRows)}},mounted:function(){this.loadReturns()},methods:{loadReturns:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var r,n,a,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,t.$http.get("/return-header");case 4:r=e.sent,n=r.data||[],n=t.applyFilters(n),n.sort((function(e,r){var n=e[t.sortBy],a=r[t.sortBy];return t.sortDesc?n>a?-1:n<a?1:0:n<a?-1:n>a?1:0})),t.totalRows=n.length,a=(t.currentPage-1)*t.perPage,s=a+t.perPage,t.returns=n.slice(a,s),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),console.error("Error loading returns:",e.t0),t.$toast({component:l["default"],props:{title:"Error",icon:"XIcon",text:"Failed to load returns",variant:"danger"}});case 18:return e.prev=18,t.loading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,14,18,21]])})))()},applyFilters:function(t){var e=this,r=t;if(this.filters.search){var n=this.filters.search.toLowerCase();r=r.filter((function(t){var e,r,a=(t.returnNumber||"").toLowerCase(),s=((null===(e=t.originalSalesHeader)||void 0===e?void 0:e.salesNumber)||"").toLowerCase(),i=((null===(r=t.returnVoucher)||void 0===r?void 0:r.voucherNumber)||"").toLowerCase();return a.includes(n)||s.includes(n)||i.includes(n)}))}return this.filters.dateFrom&&(r=r.filter((function(t){var r=p()(t.returnDate).format("YYYY-MM-DD");return r>=e.filters.dateFrom}))),this.filters.dateTo&&(r=r.filter((function(t){var r=p()(t.returnDate).format("YYYY-MM-DD");return r<=e.filters.dateTo}))),this.filters.returnType&&(r=r.filter((function(t){return t.returnType===e.filters.returnType}))),this.filters.voucherStatus&&(r=r.filter((function(t){return t.returnVoucher&&t.returnVoucher.status===e.filters.voucherStatus}))),this.filters.syncStatus&&"all"!==this.filters.syncStatus&&(r=r.filter((function(t){return t.synchronizationStatus===e.filters.syncStatus}))),r},onFilterChange:function(){this.currentPage=1,this.loadReturns()},onPageChange:function(t){this.currentPage=t,this.loadReturns()},onPerPageChange:function(){this.currentPage=1,this.loadReturns()},clearSearch:function(){this.filters.search="",this.onFilterChange()},toggleFilters:function(){this.filtersExpanded=!this.filtersExpanded},resetFilters:function(){var t=new Date,e=t.toISOString().split("T")[0];this.filters={search:"",dateFrom:e,dateTo:e,returnType:null,voucherStatus:null,syncStatus:"all"},this.currentPage=1,this.loadReturns()},viewReturnDetails:function(t){var e=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var n;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$http.get("/return-header/".concat(t.id,"/details"));case 3:n=r.sent,e.selectedReturn=Object(s["a"])(Object(s["a"])({},n.data.returnHeader),{},{synchronizationStatus:n.data.returnHeader.synchronizationStatus||t.synchronizationStatus,erpNo:n.data.returnHeader.erpNo||t.erpNo}),e.selectedReturn.returnLines=n.data.returnLines,e.showDetailsModal=!0,r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](0),console.error("Error loading return details:",r.t0),e.$toast({component:l["default"],props:{title:"Error",icon:"XIcon",text:"Failed to load return details",variant:"danger"}});case 13:case"end":return r.stop()}}),r,null,[[0,9]])})))()},printVoucher:function(t){var e=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var n,a,o,u,m,p,f,h,b,g,v,y;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.returnVoucher){r.next=3;break}return e.$toast({component:l["default"],props:{title:"Error",icon:"XIcon",text:"No voucher found for this return",variant:"warning"}}),r.abrupt("return");case 3:if(o=t,o.returnLines){r.next=17;break}return r.prev=5,r.next=8,e.$http.get("/return-header/".concat(t.id,"/details"));case 8:u=r.sent,o=Object(s["a"])(Object(s["a"])({},u.data.returnHeader),{},{returnLines:u.data.returnLines}),r.next=17;break;case 12:return r.prev=12,r.t0=r["catch"](5),console.error("Error loading return details for printing:",r.t0),e.$toast({component:l["default"],props:{title:"Error",icon:"XIcon",text:"Failed to load return details for printing",variant:"danger"}}),r.abrupt("return");case 17:return m=o.returnLines||[],p={salesNumber:o.returnVoucher.voucherNumber,salesDate:o.returnVoucher.voucherDate,totalAmount:o.returnVoucher.voucherAmount,subtotal:o.returnVoucher.voucherAmount,taxAmount:0,discountAmount:0,paidAmount:o.returnVoucher.voucherAmount,changeAmount:0,notes:"Return Voucher - Original Ticket: ".concat((null===(n=o.originalSalesHeader)||void 0===n?void 0:n.salesNumber)||"N/A"),createdByUser:{fullName:"System",username:"System"},cashierSession:null,customer:o.returnVoucher.customerName?{name:o.returnVoucher.customerName}:null,salesLines:m.map((function(t){return{item:{name:t.item?t.item.name:"Unknown Item",itemCode:t.item?t.item.itemCode:null},quantity:t.quantity,unitPrice:t.unitPrice,lineTotal:t.lineTotal}})),paymentHeaders:[{paymentMethod:{name:"Return Voucher"},totalAmount:o.returnVoucher.voucherAmount,paymentReference:o.returnVoucher.voucherNumber}]},p.isVoucher=!0,p.voucherInfo={voucherNumber:o.returnVoucher.voucherNumber,expiryDate:o.returnVoucher.expiryDate,originalTicket:(null===(a=o.originalSalesHeader)||void 0===a?void 0:a.salesNumber)||"N/A",returnNumber:o.returnNumber},f=e.$root.constructor||e.$options._base,h=f.extend(c["a"]),b=new h({parent:e,propsData:{saleData:p,isVoucher:!0,isDuplicate:!0}}),b.$mount(),r.next=27,e.$nextTick();case 27:return r.next=29,new Promise((function(t){return setTimeout(t,200)}));case 29:if(g=o.returnVoucher.voucherNumber||null,g&&b.$el)try{v=b.$el.querySelector(".barcode-svg"),v&&d()(v,g,{format:"CODE128",width:1.5,height:40,displayValue:!1,margin:5,background:"#ffffff",lineColor:"#000000"})}catch(i){console.error("Error generating barcode:",i)}if(y=window.open("","_blank"),y){r.next=35;break}return e.$toast({component:l["default"],props:{title:"Print Error",icon:"XIcon",text:"Please allow popups to print vouchers",variant:"warning"}}),r.abrupt("return");case 35:y.document.write("\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Return Voucher - ".concat(o.returnVoucher.voucherNumber," - DUPLICATE</title>\n          <style>\n            @page {\n              size: 80mm auto;\n              margin: 0;\n            }\n            body {\n              margin: 0;\n              padding: 10mm;\n              font-family: 'Courier New', monospace;\n              font-size: 12px;\n              line-height: 1.4;\n              background: white;\n              color: black;\n            }\n            .receipt-template {\n              width: 100%;\n              max-width: 80mm;\n            }\n            .receipt-header { margin-bottom: 15px; }\n            .receipt-header h2 { font-size: 16px; margin: 5px 0; font-weight: bold; text-align: center; }\n            .receipt-header h3 { font-size: 14px; margin: 5px 0; font-weight: bold; text-align: center; }\n            .receipt-divider { margin: 8px 0; text-align: center; }\n            .receipt-info, .receipt-items, .receipt-totals, .receipt-payments { margin-bottom: 10px; }\n            .receipt-row { display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 12px; }\n            .receipt-row.total { font-weight: bold; font-size: 14px; margin-top: 8px; }\n            .receipt-row .label { text-align: left; }\n            .receipt-row .value { text-align: right; font-weight: bold; }\n            .item-name { flex: 2; text-align: left; }\n            .item-qty { flex: 0.5; text-align: center; }\n            .item-total { flex: 1; text-align: right; }\n            .item-code { font-size: 10px; color: #666; margin-left: 10px; margin-bottom: 6px; }\n            .receipt-section-header { font-weight: bold; text-align: center; margin: 8px 0; }\n            .receipt-footer { margin-top: 20px; text-align: center; font-size: 11px; }\n            .receipt-item { margin-bottom: 8px; }\n            .payment-entry { margin-bottom: 8px; }\n            .voucher-badge {\n              background: #007bff;\n              color: white;\n              font-weight: bold;\n              text-align: center;\n              padding: 8px;\n              margin: 10px 0;\n              font-size: 14px;\n              border: 2px solid #000;\n            }\n            .duplicate-badge {\n              background: #ff0000 !important;\n              color: white !important;\n              font-weight: bold !important;\n              text-align: center !important;\n              padding: 10px !important;\n              margin: 10px 0 !important;\n              font-size: 18px !important;\n              border: 3px solid #000 !important;\n              letter-spacing: 2px !important;\n            }\n            .receipt-barcode { margin: 15px 0; text-align: center; }\n            .barcode-container { display: flex; justify-content: center; align-items: center; margin: 10px 0; }\n            .barcode-svg { max-width: 100%; height: auto; }\n            .barcode-text { font-size: 11px; font-weight: bold; margin-top: 5px; letter-spacing: 1px; text-align: center; }\n          </style>\n        </head>\n        <body>\n          ").concat(b.$el.outerHTML,"\n        </body>\n        </html>\n      ")),y.document.close(),setTimeout((function(){y.focus(),y.print(),setTimeout((function(){y.close(),b&&b.$el&&b.$destroy()}),1e3)}),500);case 38:case"end":return r.stop()}}),r,null,[[5,12]])})))()},getRemainingAmount:function(t){if(!t)return 0;var e=t.voucherAmount||0,r=t.usedAmount||0;return Math.max(0,e-r)},isVoucherExpired:function(t){return!(!t||!t.expiryDate)&&p()().isAfter(p()(t.expiryDate))},getVoucherStatusVariant:function(t){switch(t){case"PENDING":return"success";case"USED":return"info";case"EXPIRED":return"danger";default:return"secondary"}},formatPrice:function(t){return t||0===t?parseFloat(t).toFixed(2):"0.00"},formatDate:function(t){return t?p()(t).format("YYYY-MM-DD HH:mm"):""},formatSyncStatus:function(t){return t?t.split("_").map((function(t){return t.charAt(0)+t.slice(1).toLowerCase()})).join(" "):"Not Synced"},getSyncStatusVariant:function(t){if(!t)return"secondary";switch(t){case"TOTALLY_SYNCHED":return"success";case"PARTIALLY_SYNCHED":return"warning";case"NOT_SYNCHED":return"secondary";default:return"secondary"}},getSyncStatusIcon:function(t){if(!t)return"XIcon";switch(t){case"TOTALLY_SYNCHED":return"CheckCircleIcon";case"PARTIALLY_SYNCHED":return"AlertCircleIcon";case"NOT_SYNCHED":return"XCircleIcon";default:return"XCircleIcon"}},getSyncedLinesCount:function(t){var e=this;return t&&Array.isArray(t)?t.filter((function(t){return e.isSynched(t.synched)})).length:0},isSynched:function(t){return!0===t||"true"===t||1===t}}},h=f,b=(r("a90c"),r("2877")),g=Object(b["a"])(h,n,a,!1,null,"3832a11e",null);e["default"]=g.exports},"2b1f":function(t,e,r){},"4e82":function(t,e,r){"use strict";var n=r("23e7"),a=r("1c0b"),s=r("7b0b"),i=r("d039"),o=r("a640"),l=[],c=l.sort,u=i((function(){l.sort(void 0)})),d=i((function(){l.sort(null)})),m=o("sort"),p=u||!d||!m;n({target:"Array",proto:!0,forced:p},{sort:function(t){return void 0===t?c.call(s(this)):c.call(s(this),a(t))}})},"841c":function(t,e,r){"use strict";var n=r("d784"),a=r("825a"),s=r("1d80"),i=r("129f"),o=r("14c3");n("search",1,(function(t,e,r){return[function(e){var r=s(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,r):new RegExp(e)[t](String(r))},function(t){var n=r(e,t,this);if(n.done)return n.value;var s=a(t),l=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var u=o(s,l);return i(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))},a90c:function(t,e,r){"use strict";r("2b1f")}}]);
//# sourceMappingURL=chunk-ff2d1a3e.16d14e7b.js.map