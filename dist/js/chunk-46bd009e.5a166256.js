(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46bd009e"],{"08bd":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"erp-job-statistics-container"},[s("div",{staticClass:"page-header"},[s("h2",{staticClass:"mb-0"},[t._v("ERP Job Statistics")]),s("b-button",{attrs:{variant:"outline-primary",disabled:t.loading},on:{click:t.loadStatistics}},[s("feather-icon",{staticClass:"mr-50",attrs:{icon:"RefreshCwIcon",size:"16"}}),t._v(" Refresh ")],1)],1),s("b-card",{staticClass:"mb-3"},[s("b-row",[s("b-col",{attrs:{cols:"12",md:"6"}},[s("b-form-group",{attrs:{label:"Job","label-for":"job-selector"}},[s("b-form-select",{attrs:{id:"job-selector",options:t.jobOptions},on:{change:t.loadStatistics},model:{value:t.selectedJobId,callback:function(e){t.selectedJobId=e},expression:"selectedJobId"}})],1)],1),s("b-col",{attrs:{cols:"12",md:"3"}},[s("b-form-group",{attrs:{label:"Time Period","label-for":"time-period"}},[s("b-form-select",{attrs:{id:"time-period",options:t.timePeriodOptions},on:{change:t.onTimePeriodChange},model:{value:t.timePeriod,callback:function(e){t.timePeriod=e},expression:"timePeriod"}})],1)],1),s("b-col",{attrs:{cols:"12",md:"3"}},["CUSTOM"===t.timePeriod?s("b-form-group",{attrs:{label:"Custom From","label-for":"custom-from"}},[s("b-form-input",{attrs:{id:"custom-from",type:"datetime-local"},model:{value:t.customFromDate,callback:function(e){t.customFromDate=e},expression:"customFromDate"}})],1):t._e(),"CUSTOM"===t.timePeriod?s("b-form-group",{attrs:{label:"Custom To","label-for":"custom-to"}},[s("b-form-input",{attrs:{id:"custom-to",type:"datetime-local"},model:{value:t.customToDate,callback:function(e){t.customToDate=e},expression:"customToDate"}})],1):t._e()],1)],1)],1),t.statistics?s("b-row",{staticClass:"mb-3"},[s("b-col",{attrs:{cols:"12",md:"3"}},[s("b-card",{staticClass:"text-center"},[s("h3",{staticClass:"mb-1"},[t._v(t._s(t.statistics.totalExecutions||0))]),s("p",{staticClass:"mb-0 text-muted"},[t._v("Total Executions")])])],1),s("b-col",{attrs:{cols:"12",md:"3"}},[s("b-card",{staticClass:"text-center"},[s("h3",{staticClass:"mb-1 text-success"},[t._v(" "+t._s(null!=t.statistics.successRate?t.statistics.successRate.toFixed(1):"—")+"% ")]),s("p",{staticClass:"mb-0 text-muted"},[t._v("Success Rate")])])],1),s("b-col",{attrs:{cols:"12",md:"3"}},[s("b-card",{staticClass:"text-center"},[s("h3",{staticClass:"mb-1"},[t._v(" "+t._s(null!=t.statistics.averageDurationMs?t.formatDuration(t.statistics.averageDurationMs):"—")+" ")]),s("p",{staticClass:"mb-0 text-muted"},[t._v("Avg Duration")])])],1),s("b-col",{attrs:{cols:"12",md:"3"}},[s("b-card",{staticClass:"text-center"},[s("h3",{staticClass:"mb-1 text-info"},[t._v(" "+t._s(t.statistics.successfulExecutions||0)+" / "+t._s(t.statistics.failedExecutions||0)+" ")]),s("p",{staticClass:"mb-0 text-muted"},[t._v("Success / Fail")])])],1)],1):t._e(),t.statistics?s("b-row",{staticClass:"mb-3"},[s("b-col",{attrs:{cols:"12"}},[s("b-card",[s("h5",{staticClass:"mb-3"},[t._v(t._s(t.getPeriodTitle()))]),s("b-row",[s("b-col",{attrs:{cols:"12",md:"6"}},[s("p",{staticClass:"mb-1"},[s("strong",[t._v("Total:")]),t._v(" "+t._s(t.statistics.totalExecutions||0))]),s("p",{staticClass:"mb-1"},[s("strong",[t._v("Success Rate:")]),t._v(" "+t._s(null!=t.statistics.successRate?t.statistics.successRate.toFixed(1):"—")+"% ")])]),s("b-col",{attrs:{cols:"12",md:"6"}},[s("p",{staticClass:"mb-1"},[s("strong",[t._v("Avg Duration:")]),t._v(" "+t._s(null!=t.statistics.averageDurationMs?t.formatDuration(t.statistics.averageDurationMs):"—")+" ")]),s("p",{staticClass:"mb-1"},[s("strong",[t._v("Failed:")]),t._v(" "+t._s(t.statistics.failedExecutions||0))])])],1)],1)],1)],1):t._e(),s("b-card",[s("h5",{staticClass:"mb-3"},[t._v("Recent Execution History (Last 10 executions)")]),s("b-table",{attrs:{items:t.executionHistory,fields:t.historyFields,striped:"",hover:"",responsive:"","show-empty":"",busy:t.loading},scopedSlots:t._u([{key:"table-busy",fn:function(){return[s("div",{staticClass:"text-center my-2"},[s("b-spinner",{staticClass:"align-middle"}),s("strong",{staticClass:"ml-1"},[t._v("Loading...")])],1)]},proxy:!0},{key:"empty",fn:function(){return[s("div",{staticClass:"text-center py-4"},[s("feather-icon",{staticClass:"text-muted mb-2",attrs:{icon:"InboxIcon",size:"48"}}),s("p",{staticClass:"text-muted mb-0"},[t._v("No execution history found.")])],1)]},proxy:!0},{key:"cell(startedAt)",fn:function(e){return[t._v(" "+t._s(t.formatDateTime(e.item.startedAt))+" ")]}},{key:"cell(durationMs)",fn:function(e){return[null!=e.item.durationMs?s("span",[t._v(" "+t._s(t.formatDuration(e.item.durationMs))+" ")]):s("span",{staticClass:"text-muted"},[t._v("—")])]}},{key:"cell(status)",fn:function(e){return[s("b-badge",{attrs:{variant:t.statusVariant(e.item.status)}},[t._v(" "+t._s(e.item.status)+" ")])]}},{key:"cell(errorMessage)",fn:function(e){return[e.item.errorMessage?s("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.truncateText(e.item.errorMessage,50))+" ")]):s("span",{staticClass:"text-muted"},[t._v("—")])]}}])})],1)],1)},o=[],r=s("c7eb"),i=s("1da1"),n=(s("99af"),s("7db0"),s("a15b9"),s("d81d"),s("fb6a"),s("b680"),s("d3b7"),s("25f0"),s("159b"),s("c1df")),c=s.n(n),u=s("223c"),l={name:"ErpJobStatistics",data:function(){return{loading:!1,jobs:[],selectedJobId:null,statistics:null,timePeriod:"7_DAYS",timePeriodOptions:[{value:"7_DAYS",text:"Last 7 days"},{value:"30_DAYS",text:"Last 30 days"},{value:"CUSTOM",text:"Custom range"}],customFromDate:null,customToDate:null,customDateTimeout:null,historyFields:[{key:"startedAt",label:"Started At",sortable:!0},{key:"durationMs",label:"Duration",sortable:!1},{key:"status",label:"Status",sortable:!1},{key:"errorMessage",label:"Error",sortable:!1}]}},computed:{jobOptions:function(){var t=this,e=[{value:null,text:"All Jobs"}];return this.jobs.forEach((function(s){e.push({value:s.id,text:t.formatJobType(s.jobType)})})),e},executionHistory:function(){return this.statistics&&this.statistics.recentExecutions||[]}},mounted:function(){var t=this;this.loadJobs().then((function(){t.$route.params.jobId&&(t.selectedJobId=parseInt(t.$route.params.jobId,10)),t.selectedJobId&&t.loadStatistics()}))},methods:{loadJobs:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.get("/admin/erp/jobs");case 3:return s=e.sent,t.jobs=Array.isArray(s.data)?s.data:[],t.selectedJobId&&!t.jobs.find((function(e){return e.id===t.selectedJobId}))&&(t.selectedJobId=null),e.abrupt("return",Promise.resolve());case 9:return e.prev=9,e.t0=e["catch"](0),console.error("Error loading jobs:",e.t0),e.abrupt("return",Promise.resolve());case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},loadStatistics:function(){var t=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var s,a,o,i,n,l,m;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.selectedJobId){e.next=3;break}return t.statistics=null,e.abrupt("return");case 3:if(t.loading=!0,e.prev=4,s="/admin/erp/jobs/".concat(t.selectedJobId,"/statistics"),a=[],"7_DAYS"!==t.timePeriod){e.next=12;break}o=c()().subtract(7,"days").startOf("day").toISOString(),a.push("fromDate=".concat(encodeURIComponent(o))),e.next=25;break;case 12:if("30_DAYS"!==t.timePeriod){e.next=17;break}i=c()().subtract(30,"days").startOf("day").toISOString(),a.push("fromDate=".concat(encodeURIComponent(i))),e.next=25;break;case 17:if("CUSTOM"!==t.timePeriod){e.next=25;break}if(t.customFromDate&&t.customToDate){e.next=21;break}return t.loading=!1,e.abrupt("return");case 21:n=c()(t.customFromDate).toISOString(),l=c()(t.customToDate).toISOString(),a.push("fromDate=".concat(encodeURIComponent(n))),a.push("toDate=".concat(encodeURIComponent(l)));case 25:return a.length>0&&(s+="?"+a.join("&")),e.next=28,t.$http.get(s);case 28:m=e.sent,t.statistics=m.data||null,e.next=36;break;case 32:e.prev=32,e.t0=e["catch"](4),console.error("Error loading statistics:",e.t0),t.$toast({component:u["default"],props:{title:"Error",icon:"AlertCircleIcon",text:"Failed to load statistics",variant:"danger"}});case 36:return e.prev=36,t.loading=!1,e.finish(36);case 39:case"end":return e.stop()}}),e,null,[[4,32,36,39]])})))()},onTimePeriodChange:function(){"CUSTOM"!==this.timePeriod&&(this.customFromDate=null,this.customToDate=null),this.loadStatistics()},getPeriodTitle:function(){switch(this.timePeriod){case"7_DAYS":return"Last 7 Days Statistics";case"30_DAYS":return"Last 30 Days Statistics";case"CUSTOM":if(this.customFromDate&&this.customToDate){var t=c()(this.customFromDate).format("YYYY-MM-DD"),e=c()(this.customToDate).format("YYYY-MM-DD");return"Custom Range Statistics (".concat(t," to ").concat(e,")")}return"Custom Range Statistics";default:return"Statistics"}},formatJobType:function(t){return t?t.toString().toLowerCase().split("_").map((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})).join(" "):"Unknown"},formatDateTime:function(t){return t?c()(t).format("YYYY-MM-DD HH:mm:ss"):"—"},formatDuration:function(t){if(null==t)return"—";if(t<1e3)return"".concat(t,"ms");var e=(t/1e3).toFixed(2);if(parseFloat(e)<60)return"".concat(e,"s");var s=Math.floor(t/6e4),a=(t%6e4/1e3).toFixed(0);return"".concat(s,"m ").concat(a,"s")},statusVariant:function(t){if(!t)return"secondary";var e=t.toUpperCase();return"SUCCESS"===e?"success":"ERROR"===e||"FAILED"===e?"danger":"WARNING"===e?"warning":"secondary"},truncateText:function(t,e){return!t||t.length<=e?t:t.substring(0,e)+"..."}},beforeDestroy:function(){this.customDateTimeout&&clearTimeout(this.customDateTimeout)},watch:{selectedJobId:function(){this.loadStatistics()},"$route.params.jobId":function(t){t&&(this.selectedJobId=parseInt(t,10))},customFromDate:function(t,e){var s=this;"CUSTOM"===this.timePeriod&&t&&this.customToDate&&t!==e&&(clearTimeout(this.customDateTimeout),this.customDateTimeout=setTimeout((function(){s.loadStatistics()}),500))},customToDate:function(t,e){var s=this;"CUSTOM"===this.timePeriod&&this.customFromDate&&t&&t!==e&&(clearTimeout(this.customDateTimeout),this.customDateTimeout=setTimeout((function(){s.loadStatistics()}),500))}}},m=l,d=(s("fd72"),s("2877")),b=Object(d["a"])(m,a,o,!1,null,"1b7fc80a",null);e["default"]=b.exports},1148:function(t,e,s){"use strict";var a=s("a691"),o=s("1d80");t.exports="".repeat||function(t){var e=String(o(this)),s="",r=a(t);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(s+=e);return s}},"408a":function(t,e,s){var a=s("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=a(t))throw TypeError("Incorrect invocation");return+t}},ace8:function(t,e,s){},b680:function(t,e,s){"use strict";var a=s("23e7"),o=s("a691"),r=s("408a"),i=s("1148"),n=s("d039"),c=1..toFixed,u=Math.floor,l=function(t,e,s){return 0===e?s:e%2===1?l(t,e-1,s*t):l(t*t,e/2,s)},m=function(t){var e=0,s=t;while(s>=4096)e+=12,s/=4096;while(s>=2)e+=1,s/=2;return e},d=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n((function(){c.call({})}));a({target:"Number",proto:!0,forced:d},{toFixed:function(t){var e,s,a,n,c=r(this),d=o(t),b=[0,0,0,0,0,0],f="",p="0",h=function(t,e){var s=-1,a=e;while(++s<6)a+=t*b[s],b[s]=a%1e7,a=u(a/1e7)},v=function(t){var e=6,s=0;while(--e>=0)s+=b[e],b[e]=u(s/t),s=s%t*1e7},x=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==b[t]){var s=String(b[t]);e=""===e?s:e+i.call("0",7-s.length)+s}return e};if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(f="-",c=-c),c>1e-21)if(e=m(c*l(2,69,1))-69,s=e<0?c*l(2,-e,1):c/l(2,e,1),s*=4503599627370496,e=52-e,e>0){h(0,s),a=d;while(a>=7)h(1e7,0),a-=7;h(l(10,a,1),0),a=e-1;while(a>=23)v(1<<23),a-=23;v(1<<a),h(1,1),v(2),p=x()}else h(0,s),h(1<<-e,0),p=x()+i.call("0",d);return d>0?(n=p.length,p=f+(n<=d?"0."+i.call("0",d-n)+p:p.slice(0,n-d)+"."+p.slice(n-d))):p=f+p,p}})},fd72:function(t,e,s){"use strict";s("ace8")}}]);
//# sourceMappingURL=chunk-46bd009e.5a166256.js.map